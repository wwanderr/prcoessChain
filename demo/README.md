# è¿›ç¨‹é“¾ç”Ÿæˆç³»ç»Ÿ

> åŸºäºSpringBoot 2.x + Elasticsearchçš„å®‰å…¨äº‹ä»¶è¿›ç¨‹é“¾ç”Ÿæˆç³»ç»Ÿ

[![Java](https://img.shields.io/badge/Java-1.8-blue.svg)](https://www.oracle.com/java/)
[![SpringBoot](https://img.shields.io/badge/SpringBoot-2.7.18-brightgreen.svg)](https://spring.io/projects/spring-boot)
[![Elasticsearch](https://img.shields.io/badge/Elasticsearch-7.17.15-yellow.svg)](https://www.elastic.co/)

## ğŸ“– é¡¹ç›®ç®€ä»‹

æœ¬ç³»ç»Ÿæ˜¯ä¸€ä¸ªä¼ä¸šçº§çš„å®‰å…¨äº‹ä»¶è¿›ç¨‹é“¾ç”Ÿæˆç³»ç»Ÿï¼Œç”¨äºåˆ†æå’Œå¯è§†åŒ–å®‰å…¨å‘Šè­¦çš„è¿›ç¨‹å…³ç³»é“¾ã€‚ç³»ç»Ÿé€šè¿‡åˆ†æEDRå‘Šè­¦å’ŒåŸå§‹æ—¥å¿—ï¼Œè‡ªåŠ¨æ„å»ºå®Œæ•´çš„è¿›ç¨‹è°ƒç”¨é“¾è·¯ï¼Œå¸®åŠ©å®‰å…¨åˆ†æå¸ˆå¿«é€Ÿå®šä½æ”»å‡»è·¯å¾„å’Œå¨èƒæºå¤´ã€‚

### æ ¸å¿ƒç‰¹æ€§

- ğŸš€ **é«˜æ€§èƒ½æ‰¹é‡æŸ¥è¯¢** - ESæ‰¹é‡æŸ¥è¯¢ä¼˜åŒ–ï¼Œæ€§èƒ½æå‡10-1000å€
- ğŸ›¡ï¸ **æ™ºèƒ½å‘Šè­¦é€‰ä¸¾** - å¤šç»´åº¦å‘Šè­¦ä¼˜å…ˆçº§ç®—æ³•
- ğŸ”„ **åŒå‘è¿›ç¨‹è¿½æº¯** - å‘ä¸Šè¿½æº¯çˆ¶è¿›ç¨‹ + å‘ä¸‹æ¢æŸ¥å­è¿›ç¨‹
- ğŸ¯ **æ™ºèƒ½èŠ‚ç‚¹è£å‰ª** - åŸºäºé‡è¦æ€§è¯„åˆ†çš„èŠ‚ç‚¹è£å‰ªæœºåˆ¶
- ğŸ”’ **å®Œå–„å¼‚å¸¸å¤„ç†** - åˆ†å±‚å¼‚å¸¸ä¿æŠ¤ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§
- ğŸ“Š **RESTful API** - æ ‡å‡†çš„RESTæ¥å£ï¼Œæ˜“äºé›†æˆ

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     REST API (Controller)                    â”‚
â”‚                  /api/processchain/generate                  â”‚
â”‚              /api/processchain/batch-generate                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Service Layer (æœåŠ¡å±‚)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ProcessChainService   â”‚  â”‚OptimizedESQueryService      â”‚  â”‚
â”‚  â”‚- æµç¨‹ç¼–æ’            â”‚  â”‚- æ‰¹é‡å‘Šè­¦æŸ¥è¯¢ (MultiSearch)  â”‚  â”‚
â”‚  â”‚- å‘Šè­¦é€‰ä¸¾            â”‚  â”‚- æ‰¹é‡æ—¥å¿—æŸ¥è¯¢ (Terms Query)  â”‚  â”‚
â”‚  â”‚- æ—¥å¿—æŸ¥è¯¢            â”‚  â”‚                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Builder Layer (æ„å»ºå±‚)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚           ProcessChainBuilder (æ ¸å¿ƒç®—æ³•)                â”‚ â”‚
â”‚  â”‚  - åŒå‘éå† (traverseUpward / traverseDownward)        â”‚ â”‚
â”‚  â”‚  - ç¯æ£€æµ‹ (visitedNodesInPath)                         â”‚ â”‚
â”‚  â”‚  - æ·±åº¦é™åˆ¶ (MAX_TRAVERSE_DEPTH = 50)                  â”‚ â”‚
â”‚  â”‚  - èŠ‚ç‚¹è£å‰ª (æ™ºèƒ½è¯„åˆ†ï¼Œä¿ç•™400ä¸ªé‡è¦èŠ‚ç‚¹)                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Util Layer (å·¥å…·å±‚)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚AlarmElectionUtil â”‚  â”‚DataConverter   â”‚  â”‚TimeUtil     â”‚ â”‚
â”‚  â”‚- å‘Šè­¦é€‰ä¸¾ç®—æ³•     â”‚  â”‚- Mapâ†’POJOè½¬æ¢  â”‚  â”‚- æ—¶é—´è®¡ç®—   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Elasticsearch (RestHighLevelClient)                â”‚
â”‚  - å‘Šè­¦ç´¢å¼• (alarm_index)                                     â”‚
â”‚  - æ—¥å¿—ç´¢å¼• (log_index)                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Java 8+
- Maven 3.x
- Elasticsearch 7.xï¼ˆè¿è¡Œä¸­ï¼‰

### 1. é…ç½®ESè¿æ¥

ç¼–è¾‘ `src/main/resources/application.yml`:

```yaml
elasticsearch:
  hosts: localhost:9200  # ä¿®æ”¹ä¸ºä½ çš„ESåœ°å€
  username:              # å¦‚æœæœ‰è®¤è¯åˆ™å¡«å†™
  password:              # å¦‚æœæœ‰è®¤è¯åˆ™å¡«å†™
```

### 2. å¯åŠ¨åº”ç”¨

**æ–¹å¼1ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰**

```bash
# Windows
start.bat

# Linux/Mac
./start.sh
```

**æ–¹å¼2ï¼šä½¿ç”¨Maven**

```bash
mvn spring-boot:run
```

**æ–¹å¼3ï¼šæ‰“åŒ…è¿è¡Œ**

```bash
mvn clean package
java -jar target/process-chain-1.0.0.jar
```

### 3. éªŒè¯å¯åŠ¨

```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:8080/api/processchain/health

# å“åº”
{
  "status": "UP",
  "service": "Process Chain Generator"
}
```

## ğŸ“¡ API ä½¿ç”¨

### å•ä¸ªIPç”Ÿæˆè¿›ç¨‹é“¾

```bash
curl -X GET "http://localhost:8080/api/processchain/generate?ip=192.168.1.100"
```

**å‚æ•°**ï¼š
- `ip` (å¿…å¡«) - ç›®æ ‡IPåœ°å€
- `associatedEventId` (å¯é€‰) - ç½‘ç«¯å…³è”äº‹ä»¶ID

**å“åº”**ï¼š
```json
{
  "incidentId": "incident_123",
  "nodes": [...],
  "edges": [...],
  "foundRootNode": true
}
```

### æ‰¹é‡ç”Ÿæˆè¿›ç¨‹é“¾

```bash
curl -X POST "http://localhost:8080/api/processchain/batch-generate" \
  -H "Content-Type: application/json" \
  -d '{
    "ips": ["192.168.1.100", "192.168.1.101"],
    "associatedEventIds": {
      "192.168.1.100": "event_001"
    }
  }'
```

**å“åº”**ï¼š
```json
{
  "192.168.1.100": {
    "incidentId": "incident_123",
    "nodes": [...],
    ...
  },
  "192.168.1.101": {
    "incidentId": "incident_124",
    "nodes": [...],
    ...
  }
}
```

## ğŸ¯ æ ¸å¿ƒç®—æ³•

### å‘Šè­¦é€‰ä¸¾ç®—æ³•

```
ä¼˜å…ˆçº§è§„åˆ™ï¼š
  1. ç½‘ç«¯å…³è”å‘Šè­¦ (associatedEventIdåŒ¹é…) - æœ€é«˜ä¼˜å…ˆçº§
  2. é«˜å±å‘Šè­¦ç»„ (HIGH) - æ•°é‡æœ€å¤šä¼˜å…ˆ
  3. ä¸­å±å‘Šè­¦ç»„ (MEDIUM) - æ•°é‡æœ€å¤šä¼˜å…ˆ
  4. ä½å±å‘Šè­¦ç»„ (LOW) - æ•°é‡æœ€å¤šä¼˜å…ˆ
```

### è¿›ç¨‹é“¾æ„å»ºç®—æ³•

```
é«˜å±å‘Šè­¦ï¼šåŒå‘éå†
  â”œâ”€ å‘ä¸Šè¿½æº¯çˆ¶è¿›ç¨‹ (traverseUpward)
  â””â”€ å‘ä¸‹æ¢æŸ¥å­è¿›ç¨‹ (traverseDownward)

ä¸­ä½å±å‘Šè­¦ï¼šå‘ä¸Šéå†
  â””â”€ å‘ä¸Šè¿½æº¯çˆ¶è¿›ç¨‹ (traverseUpward)

å®‰å…¨ä¿æŠ¤ï¼š
  â”œâ”€ æœ€å¤§æ·±åº¦é™åˆ¶ï¼š50å±‚
  â”œâ”€ ç¯æ£€æµ‹ï¼švisitedNodesInPath
  â””â”€ èŠ‚ç‚¹æ•°é™åˆ¶ï¼š400ä¸ªï¼ˆè¶…è¿‡åˆ™æ™ºèƒ½è£å‰ªï¼‰
```

### æ™ºèƒ½èŠ‚ç‚¹è£å‰ª

å½“èŠ‚ç‚¹æ•°è¶…è¿‡400ä¸ªæ—¶ï¼ŒåŸºäºé‡è¦æ€§è¯„åˆ†è£å‰ªï¼š

| ç»´åº¦ | åˆ†æ•° |
|------|------|
| ç½‘ç«¯å…³è”å‘Šè­¦èŠ‚ç‚¹ | +1000 |
| é«˜å±å‘Šè­¦èŠ‚ç‚¹ | +100 |
| ä¸­å±å‘Šè­¦èŠ‚ç‚¹ | +50 |
| ä½å±å‘Šè­¦èŠ‚ç‚¹ | +20 |
| æ ¹èŠ‚ç‚¹ | +80 |
| è¿æ¥æ•°ï¼ˆæ¯ä¸ªï¼‰ | +2 (æœ€å¤š+30) |
| æœ‰æ—¥å¿—æ•°æ® | +10 |
| processç±»å‹ | +5 |

## âš¡ æ€§èƒ½ä¼˜åŒ–

### ESæ‰¹é‡æŸ¥è¯¢ä¼˜åŒ–

| åœºæ™¯ | åŸæ–¹æ¡ˆ | ä¼˜åŒ–å | æå‡ |
|------|--------|--------|------|
| 10ä¸ªIP | 20æ¬¡æŸ¥è¯¢ | 2æ¬¡æŸ¥è¯¢ | **10å€** |
| 100ä¸ªIP | 200æ¬¡æŸ¥è¯¢ | 2æ¬¡æŸ¥è¯¢ | **100å€** |
| 1000ä¸ªIP | 2000æ¬¡æŸ¥è¯¢ | 2æ¬¡æŸ¥è¯¢ | **1000å€** |

**ä¼˜åŒ–ç­–ç•¥**ï¼š
- âœ… ä½¿ç”¨`MultiSearchRequest`æ‰¹é‡æŸ¥è¯¢å‘Šè­¦
- âœ… ä½¿ç”¨`termsQuery`æ‰¹é‡æŸ¥è¯¢æ—¥å¿—
- âœ… æ—¥å¿—å“ˆå¸Œç´¢å¼•ï¼ˆO(1)æŸ¥æ‰¾ï¼‰
- âœ… æ™ºèƒ½èŠ‚ç‚¹è£å‰ªï¼ˆæ§åˆ¶å†…å­˜ï¼‰

## ğŸ“š æ–‡æ¡£å¯¼èˆª

### å¿…è¯»æ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜ | é‡è¦æ€§ |
|------|------|--------|
| [æ ¸å¿ƒä»£ç è¯¦è§£.md](æ ¸å¿ƒä»£ç è¯¦è§£.md) | 5ä¸ªæ ¸å¿ƒç±»çš„é€è¡Œè§£æ | â­â­â­â­â­ |
| [SpringBooté›†æˆè¯´æ˜.md](SpringBooté›†æˆè¯´æ˜.md) | é¡¹ç›®æ¶æ„å’ŒAPIæ–‡æ¡£ | â­â­â­â­â­ |
| [ESæ€§èƒ½ä¼˜åŒ–è¯´æ˜.md](ESæ€§èƒ½ä¼˜åŒ–è¯´æ˜.md) | ESæŸ¥è¯¢ä¼˜åŒ–ç­–ç•¥ | â­â­â­â­ |
| [é¡¹ç›®æ–‡ä»¶è¯´æ˜.md](é¡¹ç›®æ–‡ä»¶è¯´æ˜.md) | å®Œæ•´æ–‡ä»¶æ ‘å’Œé˜…è¯»æŒ‡å— | â­â­â­ |

### è¾…åŠ©æ–‡æ¡£

- [ESé›†æˆæŒ‡å—.md](ESé›†æˆæŒ‡å—.md) - ESé›†æˆè¯¦ç»†æ­¥éª¤
- [è¿›ç¨‹é“¾ä¼˜åŒ–è¯´æ˜.md](è¿›ç¨‹é“¾ä¼˜åŒ–è¯´æ˜.md) - èŠ‚ç‚¹è£å‰ªå’Œå®‰å…¨æœºåˆ¶
- [å¼‚å¸¸å¤„ç†è¯´æ˜.md](å¼‚å¸¸å¤„ç†è¯´æ˜.md) - å¼‚å¸¸å¤„ç†æœºåˆ¶
- [å¿«é€Ÿå¼€å§‹.md](å¿«é€Ÿå¼€å§‹.md) - å¿«é€Ÿä¸Šæ‰‹æŒ‡å—
- [é¡¹ç›®æ”¹é€ å®Œæˆæ€»ç»“.md](é¡¹ç›®æ”¹é€ å®Œæˆæ€»ç»“.md) - é¡¹ç›®å®Œæˆæ€»ç»“

### å­¦ä¹ è·¯çº¿

**æ–°æ‰‹å…¥é—¨**ï¼š
```
1. é˜…è¯» SpringBooté›†æˆè¯´æ˜.md (äº†è§£æ¶æ„)
2. é˜…è¯» æ ¸å¿ƒä»£ç è¯¦è§£.md (æ·±å…¥ç®—æ³•) â­
3. è¿è¡Œ start.bat (å¯åŠ¨é¡¹ç›®)
4. æµ‹è¯• REST API (è°ƒç”¨æ¥å£)
```

**å¼€å‘è€…è¿›é˜¶**ï¼š
```
1. ç†è§£ OptimizedESQueryService (æ‰¹é‡æŸ¥è¯¢)
2. æŒæ¡ ProcessChainBuilder (æ„å»ºç®—æ³•)
3. è°ƒè¯• traverseUpward/Downward (éå†è¿‡ç¨‹)
4. æ‰©å±• è‡ªå®šä¹‰è£å‰ªè§„åˆ™
```

## ğŸ› ï¸ é¡¹ç›®ç»“æ„

```
demo/
â”œâ”€â”€ pom.xml                          # Mavené…ç½®
â”œâ”€â”€ start.bat                        # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ build.bat                        # æ„å»ºè„šæœ¬
â”œâ”€â”€ README.md                        # æœ¬æ–‡ä»¶
â”œâ”€â”€ æ ¸å¿ƒä»£ç è¯¦è§£.md                    # â­ æ ¸å¿ƒæ–‡æ¡£
â”œâ”€â”€ [å…¶ä»–æ–‡æ¡£...]
â”‚
â”œâ”€â”€ src/main/
â”‚   â”œâ”€â”€ java/com/security/processchain/
â”‚   â”‚   â”œâ”€â”€ ProcessChainApplication.java           # å¯åŠ¨ç±»
â”‚   â”‚   â”œâ”€â”€ config/                               # é…ç½®ç±»
â”‚   â”‚   â”œâ”€â”€ controller/                           # REST API
â”‚   â”‚   â”œâ”€â”€ model/                                # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ service/                              # æœåŠ¡å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ OptimizedESQueryService.java     # â­ ESä¼˜åŒ–
â”‚   â”‚   â”‚   â”œâ”€â”€ ProcessChainBuilder.java         # â­ æ„å»ºå™¨
â”‚   â”‚   â”‚   â””â”€â”€ impl/ProcessChainServiceImpl.java # â­ æœåŠ¡å®ç°
â”‚   â”‚   â””â”€â”€ util/                                 # å·¥å…·ç±»
â”‚   â”‚       â”œâ”€â”€ AlarmElectionUtil.java            # å‘Šè­¦é€‰ä¸¾
â”‚   â”‚       â””â”€â”€ DataConverter.java                # æ•°æ®è½¬æ¢
â”‚   â””â”€â”€ resources/
â”‚       â””â”€â”€ application.yml                        # é…ç½®æ–‡ä»¶
â”‚
â””â”€â”€ src/test/
    â””â”€â”€ java/.../SpringBootProcessChainTest.java  # é›†æˆæµ‹è¯•
```

## ğŸ”§ é…ç½®è¯´æ˜

### application.yml

```yaml
# æœåŠ¡å™¨é…ç½®
server:
  port: 8080

# ESé…ç½®
elasticsearch:
  hosts: localhost:9200
  username:                      # å¯é€‰
  password:                      # å¯é€‰
  connection-timeout: 5000       # è¿æ¥è¶…æ—¶(ms)
  socket-timeout: 60000          # Socketè¶…æ—¶(ms)

# è¿›ç¨‹é“¾é…ç½®
process-chain:
  alarm-index: alarm_index       # å‘Šè­¦ç´¢å¼•
  log-index: log_index           # æ—¥å¿—ç´¢å¼•
  max-traversal-depth: 50        # æœ€å¤§éå†æ·±åº¦
  max-node-count: 400            # æœ€å¤§èŠ‚ç‚¹æ•°
  max-query-size: 10000          # ESæŸ¥è¯¢æœ€å¤§è¿”å›æ•°
```

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
mvn test
```

### æµ‹è¯•ç±»

- `SpringBootProcessChainTest` - SpringBooté›†æˆæµ‹è¯•
  - `testSingleIpProcessChain()` - å•ä¸ªIPæµ‹è¯•
  - `testBatchProcessChain()` - æ‰¹é‡ç”Ÿæˆæµ‹è¯•
  - `testBatchQueryPerformance()` - æ€§èƒ½å¯¹æ¯”æµ‹è¯•

## ğŸ› å¸¸è§é—®é¢˜

### 1. è¿æ¥ESå¤±è´¥

**é—®é¢˜**ï¼š`Cannot connect to Elasticsearch`

**è§£å†³**ï¼š
- æ£€æŸ¥ESæœåŠ¡æ˜¯å¦è¿è¡Œï¼š`curl http://localhost:9200`
- ç¡®è®¤`application.yml`ä¸­çš„hostsé…ç½®æ­£ç¡®
- æ£€æŸ¥ç½‘ç»œå’Œé˜²ç«å¢™è®¾ç½®

### 2. è¿›ç¨‹é“¾ä¸ºç©º

**é—®é¢˜**ï¼šè¿”å›çš„è¿›ç¨‹é“¾æ²¡æœ‰èŠ‚ç‚¹

**æ’æŸ¥**ï¼š
1. æ£€æŸ¥ESä¸­æ˜¯å¦æœ‰å‘Šè­¦æ•°æ®
2. æ£€æŸ¥å‘Šè­¦çš„traceIdæ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥æ—¥å¿—æ˜¯å¦åŒ¹é…å‘Šè­¦
4. æŸ¥çœ‹æ§åˆ¶å°è­¦å‘Šæ—¥å¿—

### 3. æŸ¥è¯¢è¶…æ—¶

**é—®é¢˜**ï¼š`SocketTimeoutException`

**è§£å†³**ï¼š
- å¢åŠ `socket-timeout`é…ç½®
- ä¼˜åŒ–ESç´¢å¼•æ€§èƒ½
- å‡å°‘`max-query-size`

æ›´å¤šé—®é¢˜å‚è€ƒï¼š[æ ¸å¿ƒä»£ç è¯¦è§£.md - ç¬¬9ç« ](æ ¸å¿ƒä»£ç è¯¦è§£.md)

## ğŸ“Š æŠ€æœ¯æŒ‡æ ‡

```
æ ¸å¿ƒä»£ç :      ~2,500è¡Œ
é…ç½®æ–‡ä»¶:      ~100è¡Œ
æ–‡æ¡£:         ~6,000è¡Œ
æµ‹è¯•ä»£ç :      ~200è¡Œ
```

**æ€§èƒ½æŒ‡æ ‡**ï¼š
- å•ä¸ªIPç”Ÿæˆï¼š< 1ç§’ï¼ˆç½‘ç»œæ­£å¸¸ï¼‰
- æ‰¹é‡10ä¸ªIPï¼š< 2ç§’
- æ‰¹é‡100ä¸ªIPï¼š< 5ç§’
- å†…å­˜å ç”¨ï¼š< 512MBï¼ˆ400èŠ‚ç‚¹ï¼‰

## ğŸš€ éƒ¨ç½²å»ºè®®

### å¼€å‘ç¯å¢ƒ

```bash
# ä½¿ç”¨start.batç›´æ¥å¯åŠ¨
start.bat
```

### ç”Ÿäº§ç¯å¢ƒ

```bash
# 1. æ‰“åŒ…
mvn clean package -DskipTests

# 2. è¿è¡Œ
java -Xmx2g -Xms1g -jar target/process-chain-1.0.0.jar \
  --spring.config.location=classpath:/application.yml
```

### Dockeréƒ¨ç½²ï¼ˆå¯é€‰ï¼‰

```dockerfile
FROM openjdk:8-jre-alpine
COPY target/process-chain-1.0.0.jar /app.jar
EXPOSE 8080
ENTRYPOINT ["java", "-jar", "/app.jar"]
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

åœ¨æäº¤ä»£ç å‰ï¼Œè¯·ç¡®ä¿ï¼š
1. âœ… ä»£ç é€šè¿‡ç¼–è¯‘
2. âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡
3. âœ… æ·»åŠ äº†å¿…è¦çš„æ³¨é‡Š
4. âœ… æ›´æ–°äº†ç›¸å…³æ–‡æ¡£

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œå†…éƒ¨ä½¿ç”¨ã€‚

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- ğŸ“– **æ–‡æ¡£**: ä¼˜å…ˆé˜…è¯»[æ ¸å¿ƒä»£ç è¯¦è§£.md](æ ¸å¿ƒä»£ç è¯¦è§£.md)
- ğŸ› **é—®é¢˜**: æŸ¥çœ‹[å¸¸è§é—®é¢˜](#-å¸¸è§é—®é¢˜)ç« èŠ‚
- ğŸ’¬ **è®¨è®º**: è”ç³»å®‰å…¨å¼€å‘å›¢é˜Ÿ

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

- [ ] æ”¯æŒæ›´å¤šæ—¥å¿—ç±»å‹ï¼ˆregistryã€dllç­‰ï¼‰
- [ ] è¿›ç¨‹é“¾å¯è§†åŒ–å‰ç«¯
- [ ] åˆ†å¸ƒå¼éƒ¨ç½²æ”¯æŒ
- [ ] æ€§èƒ½ç›‘æ§ï¼ˆPrometheusï¼‰
- [ ] ç¼“å­˜ä¼˜åŒ–ï¼ˆRedisï¼‰

---

**â­ æ¨èé˜…è¯»é¡ºåº**ï¼š
1. æœ¬READMEï¼ˆäº†è§£é¡¹ç›®æ¦‚å†µï¼‰
2. [SpringBooté›†æˆè¯´æ˜.md](SpringBooté›†æˆè¯´æ˜.md)ï¼ˆäº†è§£æ¶æ„ï¼‰
3. [æ ¸å¿ƒä»£ç è¯¦è§£.md](æ ¸å¿ƒä»£ç è¯¦è§£.md)ï¼ˆâ­â­â­â­â­ æ·±å…¥ç®—æ³•ï¼‰

é¡¹ç›®å·²Ready for Productionï¼ğŸš€

