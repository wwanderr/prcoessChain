# 矿池攻击案例链关系图

## 案例1 - 基础案例 (IP: 10.50.109.192)

```
系统进程链
┌─────────────────────────────────────────────────────────────┐
│ System → smss → winlogon → userinit → explorer             │
└─────────────────────────────────────────────────────────────┘
                                                              │
                                                              ▼
                                                      ┌─────────────┐
                                                      │ MsCpuCN64   │ ← ROOT
                                                      │ (挖矿程序)  │
                                                      └─────────────┘
```

## 案例2 - 长链场景 (IP: 192.168.3.101)

```
系统进程链
┌─────────────────────────────────────────────────────────────┐
│ System → smss → winlogon → userinit → explorer             │
└─────────────────────────────────────────────────────────────┘
                                                              │
                                                              ▼
                                                      ┌─────────────┐
                                                      │ MsCpuCN64   │ ← ROOT
                                                      │ (挖矿程序)  │
                                                      └─────────────┘
                                                              │
                                                              ▼
                                                      ┌─────────────┐
                                                      │ MsCpuCN64   │
                                                      │ (CPU绑定)   │
                                                      └─────────────┘
                                                              │
                                                              ▼
                                                      ┌─────────────┐
                                                      │ MsCpuCN64   │
                                                      │ (多线程)    │
                                                      └─────────────┘
                                                              │
                                                              ▼
                                                      ┌─────────────┐
                                                      │ MsCpuCN64   │
                                                      │ (高强度)    │
                                                      └─────────────┘
```

## 案例3 - 分支链场景 (IP: 192.168.3.102)

```
系统进程链
┌─────────────────────────────────────────────────────────────┐
│ System → smss → winlogon → userinit → explorer             │
└─────────────────────────────────────────────────────────────┘
                                                              │
                                                              ▼
                                                      ┌─────────────┐
                                                      │ MsCpuCN64   │ ← ROOT
                                                      │ (挖矿程序)  │
                                                      └─────────────┘
                                                              │
                                                              ▼
                                                      ┌─────────────┐
                                                      │ MsCpuCN64   │
                                                      │ (CPU绑定)   │
                                                      └─────────────┘
                                                              │
                                                              ▼
                                                      ┌─────────────┐
                                                      │ MsCpuCN64   │
                                                      │ (多线程)    │
                                                      └─────────────┘
                                                              │
                                                              ├─────────────────┐
                                                              ▼                 ▼
                                                      ┌─────────────┐   ┌─────────────┐
                                                      │ MsCpuCN64   │   │ xmrig.exe   │
                                                      │ (高强度)    │   │ (备用矿池)  │
                                                      └─────────────┘   └─────────────┘
```

## 案例4 - 断链场景 (IP: 192.168.3.103)

```
系统进程链
┌─────────────────────────────────────────────────────────────┐
│ System → smss → winlogon → userinit → explorer             │
└─────────────────────────────────────────────────────────────┘
                                                              │
                                                              ▼
                                                      ┌─────────────┐
                                                      │ MsCpuCN64   │ ← ROOT
                                                      │ (挖矿程序)  │
                                                      └─────────────┘
                                                              │
                                                              ▼
                                                      ┌─────────────┐
                                                      │ MsCpuCN64   │
                                                      │ (CPU绑定)   │
                                                      └─────────────┘
                                                              │
                                                              ▼
                                                      ┌─────────────┐
                                                      │   [断链]    │
                                                      └─────────────┘

独立进程链
┌─────────────────────────────────────────────────────────────┐
│ System → smss → winlogon → userinit → explorer             │
└─────────────────────────────────────────────────────────────┘
                                                              │
                                                              ▼
                                                      ┌─────────────┐
                                                      │ UNKNOWN     │
                                                      │ (独立恶意)  │
                                                      └─────────────┘
```

## 链关系总结

### 链类型对比

| 案例 | 链类型 | 节点数 | 分支数 | 断链数 | 复杂度 |
|------|--------|--------|--------|--------|--------|
| 案例1 | 基础链 | 1 | 0 | 0 | 低 |
| 案例2 | 长链 | 4 | 0 | 0 | 中 |
| 案例3 | 分支链 | 5 | 2 | 0 | 高 |
| 案例4 | 断链 | 3+1 | 0 | 1 | 中 |

### 攻击技术映射

| 进程 | 技术ID | 技术名称 | 描述 |
|------|--------|----------|------|
| MsCpuCN64 | T1496 | 资源劫持 | CPU挖矿程序 |
| xmrig | T1496 | 资源劫持 | 备用挖矿程序 |
| UNKNOWN | T1496 | 资源劫持 | 未知挖矿程序 |

### 矿池配置对比

| 案例 | 矿池地址 | 端口 | 算法 | 线程数 | 强度 |
|------|----------|------|------|--------|------|
| 案例1 | mine.ppxxmr.com | 3333 | CryptoNight | 默认 | 默认 |
| 案例2 | mine.ppxxmr.com | 3333 | CryptoNight | 4 | 15 |
| 案例3 | mine.ppxxmr.com | 3333 | CryptoNight | 4 | 15 |
| 案例3 | pool.minexmr.com | 4444 | RandomX | 8 | 默认 |
| 案例4 | mine.ppxxmr.com | 3333 | CryptoNight | 默认 | 默认 |

### 测试验证点

1. **基础功能**
   - ✅ 进程链构建
   - ✅ 网端关联
   - ✅ 根节点识别

2. **长链处理**
   - ✅ 线性链构建
   - ✅ 时间顺序
   - ✅ 父子关系

3. **分支处理**
   - ✅ 分支识别
   - ✅ 多分支构建
   - ✅ 分支独立性

4. **断链处理**
   - ✅ 断链检测
   - ✅ 独立进程处理
   - ✅ 数据分离

5. **IP隔离**
   - ✅ 不同IP隔离
   - ✅ 同IP关联
   - ✅ 网端匹配

6. **矿池特征**
   - ✅ 矿池地址识别
   - ✅ 挖矿算法检测
   - ✅ 资源使用监控
