# 案例5 - 矿池挖矿攻击链关系图

## 基本信息
- **主机地址**: 10.50.121.204
- **攻击类型**: 矿池挖矿
- **攻击描述**: Symmi家族挖矿软件回连活动事件
- **攻击源**: 10.50.86.155
- **矿池地址**: 10.50.121.204:53

- **根节点**: cmd.exe (process, processGuid: traceId-209)
- **总节点数**: 115

## 完整进程树

```
cmd.exe [traceId-209] (PID:1008)
├── powershell.exe [DB3B5B2942EEA420] (PID:1001)
│   └── cmd.exe [EEAC3840FBD87554] (PID:1006)
│       └── svchost.exe [C2DF7D30EFFFD769] (PID:1012)
│           ├── explorer.exe [1CCAA4C94ABD94DC] (PID:1016)
│           └── explorer.exe [72BB121ED3B5B03F] (PID:1019)
│               └── rundll32.exe [9F38511D24325B31] (PID:1035)
├── powershell.exe [15EE5C0247A8A427] (PID:1002)
│   └── cmd.exe [E3AF75F70EF1B868] (PID:1005)
│       ├── svchost.exe [2361434A95AF1597] (PID:1009)
│       │   └── explorer.exe [2B0AA6E2B5690857] (PID:1022)
│       │       └── rundll32.exe [632DAAA3807BE260] (PID:1037)
│       │           └── regsvr32.exe [7BEBB3C74762C8B9] (PID:1040)
│       │               ├── mshta.exe [5612AF1EF2F23B87] (PID:1084)
│       │               ├── mshta.exe [6EC77AB1E83CCBEE] (PID:1090)
│       │               └── mshta.exe [2876B769631DC34B] (PID:1105)
│       ├── svchost.exe [76D60C475FE765E4] (PID:1010)
│       │   ├── explorer.exe [2231014BA628E55A] (PID:1024)
│       │   │   └── rundll32.exe [8373EE51A90F45D7] (PID:1032)
│       │   │       ├── regsvr32.exe [786DA5D0DBF9157D] (PID:1049)
│       │   │       │   ├── mshta.exe [0F0E6E424A1180CE] (PID:1074)
│       │   │       │   ├── mshta.exe [520ED37CCFEC6805] (PID:1078)
│       │   │       │   └── mshta.exe [7580BD4AEBF545DC] (PID:1102)
│       │   │       └── regsvr32.exe [24D999B918354FD3] (PID:1055)
│       │   │           └── mshta.exe [38545A9B6B29D613] (PID:1070)
│       │   └── explorer.exe [6094BB2D3BDB5963] (PID:1025)
│       │       ├── rundll32.exe [1D5D7B87C2831C4E] (PID:1026)
│       │       │   ├── regsvr32.exe [56164C2B4BE9A9B8] (PID:1042)
│       │       │   │   ├── mshta.exe [42B5EDD2BB2B46E7] (PID:1060)
│       │       │   │   ├── mshta.exe [6B7B0CE3D3BC00FC] (PID:1061)
│       │       │   │   └── mshta.exe [29F240680F02CC3D] (PID:1113)
│       │       │   └── regsvr32.exe [0CAA3FAACC3D4D5C] (PID:1046)
│       │       │       ├── mshta.exe [35DC2A018436474D] (PID:1057)
│       │       │       └── mshta.exe [A08DD1D21A1810C0] (PID:1094)
│       │       ├── rundll32.exe [BD21369BD7E5F58E] (PID:1036)
│       │       └── rundll32.exe [4B652F966D18C32D] (PID:1038)
│       │           ├── regsvr32.exe [8A5E0B4AAC098E42] (PID:1044)
│       │           └── regsvr32.exe [9CBAE3B38D05B3F5] (PID:1047)
│       │               ├── mshta.exe [5AFEE1D29A92141C] (PID:1063)
│       │               ├── mshta.exe [0A583A7A373B083A] (PID:1064)
│       │               ├── mshta.exe [D2DB5494B7A6F123] (PID:1073)
│       │               ├── mshta.exe [B39965770BD8A5B3] (PID:1080)
│       │               ├── mshta.exe [D4FCEE67F0C87E1E] (PID:1082)
│       │               ├── mshta.exe [81435EBD73DCDF43] (PID:1086)
│       │               └── mshta.exe [33EEA24EBD102235] (PID:1100)
│       ├── svchost.exe [82770379EE93DBC8] (PID:1013)
│       └── svchost.exe [7FCAD01BF061015B] (PID:1014)
│           ├── explorer.exe [30F606B644D17244] (PID:1021)
│           │   └── rundll32.exe [350166864FF34D39] (PID:1028)
│           │       ├── regsvr32.exe [AE7B1799FC743240] (PID:1041)
│           │       │   ├── mshta.exe [7A1831441721963B] (PID:1062)
│           │       │   ├── mshta.exe [90105E8A04782751] (PID:1087)
│           │       │   ├── mshta.exe [1E0E60969E29CFA7] (PID:1104)
│           │       │   ├── mshta.exe [C04D43BA5075A35C] (PID:1106)
│           │       │   └── mshta.exe [7EB1BB7036EC814B] (PID:1109)
│           │       └── regsvr32.exe [4C039815D55DE407] (PID:1056)
│           │           ├── mshta.exe [C93EDED4CCD72708] (PID:1069)
│           │           └── mshta.exe [6DC8BFEB8B18AB9E] (PID:1107)
│           └── explorer.exe [486108EB64200B47] (PID:1023)
│               ├── rundll32.exe [C1BB32AAE4833956] (PID:1027)
│               │   ├── regsvr32.exe [E606995266F3F7A9] (PID:1050)
│               │   │   ├── mshta.exe [9EB2C450CCB0494A] (PID:1068)
│               │   │   ├── mshta.exe [4B9E0D193223C758] (PID:1096)
│               │   │   ├── mshta.exe [E4ED31AF82FB17CF] (PID:1101)
│               │   │   └── mshta.exe [613D87DEB455E794] (PID:1103)
│               │   └── regsvr32.exe [A233FD6AA45474AA] (PID:1053)
│               │       ├── mshta.exe [87DB895CED090E74] (PID:1058)
│               │       ├── mshta.exe [9F5EC66EEF39D63E] (PID:1071)
│               │       ├── mshta.exe [311138BEDCC0728C] (PID:1085)
│               │       └── mshta.exe [C8936955B1117E1E] (PID:1091)
│               ├── rundll32.exe [193DAD841D32E8A6] (PID:1031)
│               │   ├── regsvr32.exe [07D54749BE7C0FAA] (PID:1048)
│               │   │   ├── mshta.exe [432D355CCC557110] (PID:1081)
│               │   │   ├── mshta.exe [936DEA02DF2035B7] (PID:1083)
│               │   │   └── mshta.exe [95D59DBCDD231D29] (PID:1108)
│               │   └── regsvr32.exe [FB6562B0A157F55C] (PID:1054)
│               │       ├── mshta.exe [BAD3DDFE5C3DBC2C] (PID:1059)
│               │       ├── mshta.exe [06181EB40755D07F] (PID:1065)
│               │       ├── mshta.exe [E2CEF86626C8C8E2] (PID:1075)
│               │       ├── mshta.exe [7C635AC23D042566] (PID:1079)
│               │       ├── mshta.exe [71BC9B534CA9F622] (PID:1088)
│               │       ├── mshta.exe [DA4AD591704EF294] (PID:1089)
│               │       ├── mshta.exe [C88C474A96C8475F] (PID:1095)
│               │       ├── mshta.exe [59193A1AC214E2C2] (PID:1099)
│               │       └── mshta.exe [05F7C16F9CC9B01A] (PID:1110)
│               ├── rundll32.exe [82BC3A097A319FD3] (PID:1033)
│               │   ├── regsvr32.exe [1EBC6A23EAF52613] (PID:1043)
│               │   │   ├── mshta.exe [45FA4BFFD91740AE] (PID:1072)
│               │   │   ├── mshta.exe [C53B798E95A83F77] (PID:1076)
│               │   │   ├── mshta.exe [EBE6B4512BB136A1] (PID:1077)
│               │   │   ├── mshta.exe [FB441160BE8D0287] (PID:1111)
│               │   │   └── mshta.exe [F90D6B0C2AAAF5C2] (PID:1112)
│               │   └── regsvr32.exe [70070D3F43312F58] (PID:1051)
│               │       ├── mshta.exe [EE976316B321E36B] (PID:1097)
│               │       └── mshta.exe [6AB1FB9F3ACBD1F0] (PID:1098)
│               └── rundll32.exe [FA0B96AF55562177] (PID:1039)
├── powershell.exe [1B940BA09F170EBB] (PID:1003)
│   ├── cmd.exe [9FDB77AF7D5D80BE] (PID:1007)
│   │   └── svchost.exe [514E22E08320DCFF] (PID:1015)
│   │       ├── explorer.exe [3A7E4CD0FD5F3544] (PID:1017)
│   │       └── explorer.exe [CF29E172F477BD07] (PID:1020)
│   │           ├── rundll32.exe [2F0B4C70AD3F3906] (PID:1029)
│   │           ├── rundll32.exe [E741FD11CEC0FF9D] (PID:1030)
│   │           │   └── regsvr32.exe [FA867678393939EE] (PID:1045)
│   │           │       ├── mshta.exe [8E141B7E0E6985C9] (PID:1092)
│   │           │       ├── mshta.exe [38AB3BB2886F860A] (PID:1093)
│   │           │       └── mshta.exe [C9F9E00332454D9D] (PID:1114)
│   │           └── rundll32.exe [780E88CE9E8619AA] (PID:1034)
│   │               └── regsvr32.exe [4CEBC997B08E43CC] (PID:1052)
│   │                   ├── mshta.exe [7190FDEB9DCE60D9] (PID:1066)
│   │                   └── mshta.exe [8B1A58FE2BB01159] (PID:1067)
│   └── cmd.exe [traceId-209] (PID:1008)
│       ├── powershell.exe [DB3B5B2942EEA420] (PID:1001)
│       │   └── cmd.exe [EEAC3840FBD87554] (PID:1006)
│       │       └── svchost.exe [C2DF7D30EFFFD769] (PID:1012)
│       │           ├── explorer.exe [1CCAA4C94ABD94DC] (PID:1016)
│       │           └── explorer.exe [72BB121ED3B5B03F] (PID:1019)
│       │               └── rundll32.exe [9F38511D24325B31] (PID:1035)
│       ├── powershell.exe [15EE5C0247A8A427] (PID:1002)
│       │   └── cmd.exe [E3AF75F70EF1B868] (PID:1005)
│       │       ├── svchost.exe [2361434A95AF1597] (PID:1009)
│       │       │   └── explorer.exe [2B0AA6E2B5690857] (PID:1022)
│       │       │       └── rundll32.exe [632DAAA3807BE260] (PID:1037)
│       │       │           └── regsvr32.exe [7BEBB3C74762C8B9] (PID:1040)
│       │       │               ├── mshta.exe [5612AF1EF2F23B87] (PID:1084)
│       │       │               ├── mshta.exe [6EC77AB1E83CCBEE] (PID:1090)
│       │       │               └── mshta.exe [2876B769631DC34B] (PID:1105)
│       │       ├── svchost.exe [76D60C475FE765E4] (PID:1010)
│       │       │   ├── explorer.exe [2231014BA628E55A] (PID:1024)
│       │       │   │   └── rundll32.exe [8373EE51A90F45D7] (PID:1032)
│       │       │   │       ├── regsvr32.exe [786DA5D0DBF9157D] (PID:1049)
│       │       │   │       │   ├── mshta.exe [0F0E6E424A1180CE] (PID:1074)
│       │       │   │       │   ├── mshta.exe [520ED37CCFEC6805] (PID:1078)
│       │       │   │       │   └── mshta.exe [7580BD4AEBF545DC] (PID:1102)
│       │       │   │       └── regsvr32.exe [24D999B918354FD3] (PID:1055)
│       │       │   │           └── mshta.exe [38545A9B6B29D613] (PID:1070)
│       │       │   └── explorer.exe [6094BB2D3BDB5963] (PID:1025)
│       │       │       ├── rundll32.exe [1D5D7B87C2831C4E] (PID:1026)
│       │       │       │   ├── regsvr32.exe [56164C2B4BE9A9B8] (PID:1042)
│       │       │       │   │   ├── mshta.exe [42B5EDD2BB2B46E7] (PID:1060)
│       │       │       │   │   ├── mshta.exe [6B7B0CE3D3BC00FC] (PID:1061)
│       │       │       │   │   └── mshta.exe [29F240680F02CC3D] (PID:1113)
│       │       │       │   └── regsvr32.exe [0CAA3FAACC3D4D5C] (PID:1046)
│       │       │       │       ├── mshta.exe [35DC2A018436474D] (PID:1057)
│       │       │       │       └── mshta.exe [A08DD1D21A1810C0] (PID:1094)
│       │       │       ├── rundll32.exe [BD21369BD7E5F58E] (PID:1036)
│       │       │       └── rundll32.exe [4B652F966D18C32D] (PID:1038)
│       │       │           ├── regsvr32.exe [8A5E0B4AAC098E42] (PID:1044)
│       │       │           └── regsvr32.exe [9CBAE3B38D05B3F5] (PID:1047)
│       │       │               ├── mshta.exe [5AFEE1D29A92141C] (PID:1063)
│       │       │               ├── mshta.exe [0A583A7A373B083A] (PID:1064)
│       │       │               ├── mshta.exe [D2DB5494B7A6F123] (PID:1073)
│       │       │               ├── mshta.exe [B39965770BD8A5B3] (PID:1080)
│       │       │               ├── mshta.exe [D4FCEE67F0C87E1E] (PID:1082)
│       │       │               ├── mshta.exe [81435EBD73DCDF43] (PID:1086)
│       │       │               └── mshta.exe [33EEA24EBD102235] (PID:1100)
│       │       ├── svchost.exe [82770379EE93DBC8] (PID:1013)
│       │       └── svchost.exe [7FCAD01BF061015B] (PID:1014)
│       │           ├── explorer.exe [30F606B644D17244] (PID:1021)
│       │           │   └── rundll32.exe [350166864FF34D39] (PID:1028)
│       │           │       ├── regsvr32.exe [AE7B1799FC743240] (PID:1041)
│       │           │       │   ├── mshta.exe [7A1831441721963B] (PID:1062)
│       │           │       │   ├── mshta.exe [90105E8A04782751] (PID:1087)
│       │           │       │   ├── mshta.exe [1E0E60969E29CFA7] (PID:1104)
│       │           │       │   ├── mshta.exe [C04D43BA5075A35C] (PID:1106)
│       │           │       │   └── mshta.exe [7EB1BB7036EC814B] (PID:1109)
│       │           │       └── regsvr32.exe [4C039815D55DE407] (PID:1056)
│       │           │           ├── mshta.exe [C93EDED4CCD72708] (PID:1069)
│       │           │           └── mshta.exe [6DC8BFEB8B18AB9E] (PID:1107)
│       │           └── explorer.exe [486108EB64200B47] (PID:1023)
│       │               ├── rundll32.exe [C1BB32AAE4833956] (PID:1027)
│       │               │   ├── regsvr32.exe [E606995266F3F7A9] (PID:1050)
│       │               │   │   ├── mshta.exe [9EB2C450CCB0494A] (PID:1068)
│       │               │   │   ├── mshta.exe [4B9E0D193223C758] (PID:1096)
│       │               │   │   ├── mshta.exe [E4ED31AF82FB17CF] (PID:1101)
│       │               │   │   └── mshta.exe [613D87DEB455E794] (PID:1103)
│       │               │   └── regsvr32.exe [A233FD6AA45474AA] (PID:1053)
│       │               │       ├── mshta.exe [87DB895CED090E74] (PID:1058)
│       │               │       ├── mshta.exe [9F5EC66EEF39D63E] (PID:1071)
│       │               │       ├── mshta.exe [311138BEDCC0728C] (PID:1085)
│       │               │       └── mshta.exe [C8936955B1117E1E] (PID:1091)
│       │               ├── rundll32.exe [193DAD841D32E8A6] (PID:1031)
│       │               │   ├── regsvr32.exe [07D54749BE7C0FAA] (PID:1048)
│       │               │   │   ├── mshta.exe [432D355CCC557110] (PID:1081)
│       │               │   │   ├── mshta.exe [936DEA02DF2035B7] (PID:1083)
│       │               │   │   └── mshta.exe [95D59DBCDD231D29] (PID:1108)
│       │               │   └── regsvr32.exe [FB6562B0A157F55C] (PID:1054)
│       │               │       ├── mshta.exe [BAD3DDFE5C3DBC2C] (PID:1059)
│       │               │       ├── mshta.exe [06181EB40755D07F] (PID:1065)
│       │               │       ├── mshta.exe [E2CEF86626C8C8E2] (PID:1075)
│       │               │       ├── mshta.exe [7C635AC23D042566] (PID:1079)
│       │               │       ├── mshta.exe [71BC9B534CA9F622] (PID:1088)
│       │               │       ├── mshta.exe [DA4AD591704EF294] (PID:1089)
│       │               │       ├── mshta.exe [C88C474A96C8475F] (PID:1095)
│       │               │       ├── mshta.exe [59193A1AC214E2C2] (PID:1099)
│       │               │       └── mshta.exe [05F7C16F9CC9B01A] (PID:1110)
│       │               ├── rundll32.exe [82BC3A097A319FD3] (PID:1033)
│       │               │   ├── regsvr32.exe [1EBC6A23EAF52613] (PID:1043)
│       │               │   │   ├── mshta.exe [45FA4BFFD91740AE] (PID:1072)
│       │               │   │   ├── mshta.exe [C53B798E95A83F77] (PID:1076)
│       │               │   │   ├── mshta.exe [EBE6B4512BB136A1] (PID:1077)
│       │               │   │   ├── mshta.exe [FB441160BE8D0287] (PID:1111)
│       │               │   │   └── mshta.exe [F90D6B0C2AAAF5C2] (PID:1112)
│       │               │   └── regsvr32.exe [70070D3F43312F58] (PID:1051)
│       │               │       ├── mshta.exe [EE976316B321E36B] (PID:1097)
│       │               │       └── mshta.exe [6AB1FB9F3ACBD1F0] (PID:1098)
│       │               └── rundll32.exe [FA0B96AF55562177] (PID:1039)
│       └── svchost.exe [92C9A384491AE857] (PID:1011)
│           └── explorer.exe [67685116302F5276] (PID:1018)
└── svchost.exe [92C9A384491AE857] (PID:1011)
    └── explorer.exe [67685116302F5276] (PID:1018)
```

## 统计信息

### 按进程类型统计:
- **mshta.exe**: 58个实例
- **regsvr32.exe**: 17个实例
- **rundll32.exe**: 14个实例
- **explorer.exe**: 10个实例
- **svchost.exe**: 7个实例
- **cmd.exe**: 4个实例
- **powershell.exe**: 3个实例

## 说明
- 所有节点的 `hostAddress` 均为 10.50.121.204
- 根节点的 `processGuid` 等于 `traceId`
- 所有子节点通过 `parentProcessGuid` 字段连接到父节点的 `processGuid`
- 本图仅使用日志的**第一层级字段**生成，不解析 `otherFields` 等嵌套字段