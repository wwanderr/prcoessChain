# 命令执行 - 进程链关系图汇总

本文档包含案例2-5的完整进程树可视化关系图。

**图例说明**:
- 🌐 网络攻击源
- 💻 进程节点
- 📄 文件节点
- [ROOT] 根节点（告警进程）
- [ALARM] 告警节点
- [EXTEND] 扩展节点（有子进程的节点）
- 威胁等级: HIGH (高) | MEDIUM (中) | LOW (低)

---

## 案例2

### 完整进程树视图

```
└── 🌐 [command_exec] 10.50.86.152:50728 → 10.50.114.197:80 (TCP) [HIGH]
    └── 💻 [ROOT,ALARM] whoami.exe (PID:1002) - Administrator [HIGH]
        └── 📄 [webshell_file] evil.exe (unknown) [MEDIUM]
        ├── 💻 [EXTEND] cmd.exe (PID:1003) - Administrator [MEDIUM]
        │   └── 💻 [EXTEND] powershell.exe (PID:1006) - Administrator [MEDIUM]
        │       └── 💻 [EXTEND] php-cgi.exe (PID:1008) - SYSTEM [MEDIUM]
        │           └── 💻 nginx.exe (PID:1010) - SYSTEM [LOW]
        ├── 💻 [EXTEND] cmd.exe (PID:1004) - Administrator [MEDIUM]
        │   └── 💻 [EXTEND] powershell.exe (PID:1007) - Administrator [MEDIUM]
        │       └── 💻 [EXTEND] php-cgi.exe (PID:1009) - SYSTEM [MEDIUM]
        │           └── 💻 nginx.exe (PID:1011) - SYSTEM [LOW]
        └── 💻 cmd.exe (PID:1005) - Administrator [MEDIUM]
```

### 统计信息

- **进程节点数**: 10
- **文件节点数**: 1
- **网络节点数**: 1
- **总节点数**: 12
- **根进程数**: 1
- **告警进程**: whoami.exe (PID:1002)
- **恶意文件**: evil.exe (unknown)

---

## 案例3

### 完整进程树视图

```
└── 🌐 [command_exec] 10.50.86.153:50728 → 10.50.115.198:80 (TCP) [HIGH]
    └── 💻 [ROOT,ALARM] whoami.exe (PID:1000) - Administrator [HIGH]
        └── 📄 [webshell_file] evil.exe (unknown) [MEDIUM]
        └── 💻 [EXTEND] cmd.exe (PID:1001) - Administrator [MEDIUM]
            ├── 💻 [EXTEND] powershell.exe (PID:1002) - Administrator [MEDIUM]
            │   ├── 💻 php-cgi.exe (PID:1004) - SYSTEM [MEDIUM]
            │   └── 💻 [EXTEND] php-cgi.exe (PID:1006) - SYSTEM [MEDIUM]
            │       ├── 💻 [EXTEND] nginx.exe (PID:1007) - SYSTEM [LOW]
            │       │   ├── 💻 net.exe (PID:1012) - SYSTEM [LOW]
            │       │   ├── 💻 net.exe (PID:1015) - SYSTEM [LOW]
            │       │   ├── 💻 net.exe (PID:1020) - SYSTEM [LOW]
            │       │   └── 💻 net.exe (PID:1021) - SYSTEM [LOW]
            │       ├── 💻 [EXTEND] nginx.exe (PID:1008) - SYSTEM [LOW]
            │       │   ├── 💻 net.exe (PID:1013) - SYSTEM [LOW]
            │       │   └── 💻 net.exe (PID:1017) - SYSTEM [LOW]
            │       └── 💻 [EXTEND] nginx.exe (PID:1009) - SYSTEM [LOW]
            │           ├── 💻 net.exe (PID:1010) - SYSTEM [LOW]
            │           ├── 💻 net.exe (PID:1011) - SYSTEM [LOW]
            │           ├── 💻 net.exe (PID:1014) - SYSTEM [LOW]
            │           ├── 💻 net.exe (PID:1016) - SYSTEM [LOW]
            │           ├── 💻 net.exe (PID:1018) - SYSTEM [LOW]
            │           └── 💻 net.exe (PID:1019) - SYSTEM [LOW]
            └── 💻 [EXTEND] powershell.exe (PID:1003) - Administrator [MEDIUM]
                └── 💻 php-cgi.exe (PID:1005) - SYSTEM [MEDIUM]
```

### 统计信息

- **进程节点数**: 22
- **文件节点数**: 1
- **网络节点数**: 1
- **总节点数**: 24
- **根进程数**: 1
- **告警进程**: whoami.exe (PID:1000)
- **恶意文件**: evil.exe (unknown)

---

## 案例4

### 完整进程树视图

```
└── 🌐 [command_exec] 10.50.86.154:50728 → 10.50.116.199:80 (TCP) [HIGH]
    └── 💻 [ROOT,ALARM] whoami.exe (PID:1004) - Administrator [HIGH]
        └── 📄 [webshell_file] evil.exe (unknown) [MEDIUM]
        ├── 💻 [EXTEND] cmd.exe (PID:1005) - Administrator [MEDIUM]
        │   └── 💻 [EXTEND] powershell.exe (PID:1010) - Administrator [MEDIUM]
        │       └── 💻 [EXTEND] php-cgi.exe (PID:1015) - SYSTEM [MEDIUM]
        │           └── 💻 [EXTEND] nginx.exe (PID:1020) - SYSTEM [LOW]
        │               └── 💻 [EXTEND] net.exe (PID:1025) - SYSTEM [LOW]
        │                   └── 💻 reg.exe (PID:1030) - SYSTEM [LOW]
        ├── 💻 [EXTEND] cmd.exe (PID:1006) - Administrator [MEDIUM]
        │   └── 💻 [EXTEND] powershell.exe (PID:1011) - Administrator [MEDIUM]
        │       └── 💻 [EXTEND] php-cgi.exe (PID:1016) - SYSTEM [MEDIUM]
        │           └── 💻 [EXTEND] nginx.exe (PID:1021) - SYSTEM [LOW]
        │               └── 💻 [EXTEND] net.exe (PID:1026) - SYSTEM [LOW]
        │                   └── 💻 reg.exe (PID:1031) - SYSTEM [LOW]
        ├── 💻 [EXTEND] cmd.exe (PID:1007) - Administrator [MEDIUM]
        │   └── 💻 [EXTEND] powershell.exe (PID:1012) - Administrator [MEDIUM]
        │       └── 💻 [EXTEND] php-cgi.exe (PID:1017) - SYSTEM [MEDIUM]
        │           └── 💻 [EXTEND] nginx.exe (PID:1022) - SYSTEM [LOW]
        │               └── 💻 [EXTEND] net.exe (PID:1027) - SYSTEM [LOW]
        │                   └── 💻 reg.exe (PID:1032) - SYSTEM [LOW]
        ├── 💻 [EXTEND] cmd.exe (PID:1008) - Administrator [MEDIUM]
        │   └── 💻 [EXTEND] powershell.exe (PID:1013) - Administrator [MEDIUM]
        │       └── 💻 [EXTEND] php-cgi.exe (PID:1018) - SYSTEM [MEDIUM]
        │           └── 💻 [EXTEND] nginx.exe (PID:1023) - SYSTEM [LOW]
        │               └── 💻 [EXTEND] net.exe (PID:1028) - SYSTEM [LOW]
        │                   └── 💻 reg.exe (PID:1033) - SYSTEM [LOW]
        └── 💻 [EXTEND] cmd.exe (PID:1009) - Administrator [MEDIUM]
            └── 💻 [EXTEND] powershell.exe (PID:1014) - Administrator [MEDIUM]
                └── 💻 [EXTEND] php-cgi.exe (PID:1019) - SYSTEM [MEDIUM]
                    └── 💻 [EXTEND] nginx.exe (PID:1024) - SYSTEM [LOW]
                        └── 💻 [EXTEND] net.exe (PID:1029) - SYSTEM [LOW]
                            └── 💻 reg.exe (PID:1034) - SYSTEM [LOW]
```

### 统计信息

- **进程节点数**: 31
- **文件节点数**: 1
- **网络节点数**: 1
- **总节点数**: 33
- **根进程数**: 1
- **告警进程**: whoami.exe (PID:1004)
- **恶意文件**: evil.exe (unknown)

---

## 案例5

### 完整进程树视图

```
└── 🌐 [command_exec] 10.50.86.155:50728 → 10.50.117.200:80 (TCP) [HIGH]
    └── 💻 [ROOT,ALARM] whoami.exe (PID:1000) - Administrator [HIGH]
        └── 📄 [webshell_file] evil.exe (unknown) [MEDIUM]
        ├── 💻 cmd.exe (PID:1001) - Administrator [MEDIUM]
        ├── 💻 [EXTEND] cmd.exe (PID:1002) - Administrator [MEDIUM]
        │   ├── 💻 [EXTEND] powershell.exe (PID:1004) - Administrator [MEDIUM]
        │   │   └── 💻 php-cgi.exe (PID:1014) - SYSTEM [MEDIUM]
        │   └── 💻 [EXTEND] powershell.exe (PID:1005) - Administrator [MEDIUM]
        │       └── 💻 php-cgi.exe (PID:1012) - SYSTEM [MEDIUM]
        └── 💻 [EXTEND] cmd.exe (PID:1003) - Administrator [MEDIUM]
            ├── 💻 [EXTEND] powershell.exe (PID:1006) - Administrator [MEDIUM]
            │   ├── 💻 [EXTEND] php-cgi.exe (PID:1010) - SYSTEM [MEDIUM]
            │   │   ├── 💻 [EXTEND] nginx.exe (PID:1021) - SYSTEM [LOW]
            │   │   │   └── 💻 [EXTEND] net.exe (PID:1024) - SYSTEM [LOW]
            │   │   │       ├── 💻 [EXTEND] reg.exe (PID:1038) - SYSTEM [LOW]
            │   │   │       │   ├── 💻 sc.exe (PID:1087) - SYSTEM [LOW]
            │   │   │       │   ├── 💻 sc.exe (PID:1098) - SYSTEM [LOW]
            │   │   │       │   └── 💻 sc.exe (PID:1106) - SYSTEM [LOW]
            │   │   │       ├── 💻 [EXTEND] reg.exe (PID:1039) - SYSTEM [LOW]
            │   │   │       │   ├── 💻 sc.exe (PID:1089) - SYSTEM [LOW]
            │   │   │       │   └── 💻 sc.exe (PID:1091) - SYSTEM [LOW]
            │   │   │       ├── 💻 [EXTEND] reg.exe (PID:1041) - SYSTEM [LOW]
            │   │   │       │   ├── 💻 sc.exe (PID:1062) - SYSTEM [LOW]
            │   │   │       │   ├── 💻 sc.exe (PID:1069) - SYSTEM [LOW]
            │   │   │       │   ├── 💻 sc.exe (PID:1099) - SYSTEM [LOW]
            │   │   │       │   ├── 💻 sc.exe (PID:1104) - SYSTEM [LOW]
            │   │   │       │   └── 💻 sc.exe (PID:1108) - SYSTEM [LOW]
            │   │   │       └── 💻 reg.exe (PID:1051) - SYSTEM [LOW]
            │   │   └── 💻 [EXTEND] nginx.exe (PID:1023) - SYSTEM [LOW]
            │   │       └── 💻 net.exe (PID:1036) - SYSTEM [LOW]
            │   └── 💻 [EXTEND] php-cgi.exe (PID:1013) - SYSTEM [MEDIUM]
            │       ├── 💻 [EXTEND] nginx.exe (PID:1017) - SYSTEM [LOW]
            │       │   └── 💻 [EXTEND] net.exe (PID:1035) - SYSTEM [LOW]
            │       │       ├── 💻 [EXTEND] reg.exe (PID:1043) - SYSTEM [LOW]
            │       │       │   ├── 💻 sc.exe (PID:1070) - SYSTEM [LOW]
            │       │       │   └── 💻 sc.exe (PID:1103) - SYSTEM [LOW]
            │       │       ├── 💻 [EXTEND] reg.exe (PID:1047) - SYSTEM [LOW]
            │       │       │   ├── 💻 sc.exe (PID:1057) - SYSTEM [LOW]
            │       │       │   ├── 💻 sc.exe (PID:1067) - SYSTEM [LOW]
            │       │       │   ├── 💻 sc.exe (PID:1071) - SYSTEM [LOW]
            │       │       │   ├── 💻 sc.exe (PID:1074) - SYSTEM [LOW]
            │       │       │   ├── 💻 sc.exe (PID:1100) - SYSTEM [LOW]
            │       │       │   └── 💻 sc.exe (PID:1102) - SYSTEM [LOW]
            │       │       └── 💻 [EXTEND] reg.exe (PID:1048) - SYSTEM [LOW]
            │       │           └── 💻 sc.exe (PID:1101) - SYSTEM [LOW]
            │       ├── 💻 [EXTEND] nginx.exe (PID:1018) - SYSTEM [LOW]
            │       │   ├── 💻 net.exe (PID:1028) - SYSTEM [LOW]
            │       │   ├── 💻 net.exe (PID:1032) - SYSTEM [LOW]
            │       │   └── 💻 [EXTEND] net.exe (PID:1034) - SYSTEM [LOW]
            │       │       └── 💻 [EXTEND] reg.exe (PID:1042) - SYSTEM [LOW]
            │       │           ├── 💻 sc.exe (PID:1068) - SYSTEM [LOW]
            │       │           └── 💻 sc.exe (PID:1082) - SYSTEM [LOW]
            │       └── 💻 nginx.exe (PID:1022) - SYSTEM [LOW]
            └── 💻 [EXTEND] powershell.exe (PID:1007) - Administrator [MEDIUM]
                ├── 💻 php-cgi.exe (PID:1008) - SYSTEM [MEDIUM]
                ├── 💻 [EXTEND] php-cgi.exe (PID:1009) - SYSTEM [MEDIUM]
                │   ├── 💻 [EXTEND] nginx.exe (PID:1019) - SYSTEM [LOW]
                │   │   ├── 💻 [EXTEND] net.exe (PID:1026) - SYSTEM [LOW]
                │   │   │   ├── 💻 [EXTEND] reg.exe (PID:1040) - SYSTEM [LOW]
                │   │   │   │   ├── 💻 sc.exe (PID:1060) - SYSTEM [LOW]
                │   │   │   │   ├── 💻 sc.exe (PID:1065) - SYSTEM [LOW]
                │   │   │   │   ├── 💻 sc.exe (PID:1081) - SYSTEM [LOW]
                │   │   │   │   └── 💻 sc.exe (PID:1085) - SYSTEM [LOW]
                │   │   │   ├── 💻 [EXTEND] reg.exe (PID:1050) - SYSTEM [LOW]
                │   │   │   │   ├── 💻 sc.exe (PID:1056) - SYSTEM [LOW]
                │   │   │   │   ├── 💻 sc.exe (PID:1061) - SYSTEM [LOW]
                │   │   │   │   ├── 💻 sc.exe (PID:1066) - SYSTEM [LOW]
                │   │   │   │   ├── 💻 sc.exe (PID:1075) - SYSTEM [LOW]
                │   │   │   │   └── 💻 sc.exe (PID:1107) - SYSTEM [LOW]
                │   │   │   └── 💻 [EXTEND] reg.exe (PID:1053) - SYSTEM [LOW]
                │   │   │       ├── 💻 sc.exe (PID:1054) - SYSTEM [LOW]
                │   │   │       ├── 💻 sc.exe (PID:1058) - SYSTEM [LOW]
                │   │   │       ├── 💻 sc.exe (PID:1086) - SYSTEM [LOW]
                │   │   │       ├── 💻 sc.exe (PID:1092) - SYSTEM [LOW]
                │   │   │       └── 💻 sc.exe (PID:1093) - SYSTEM [LOW]
                │   │   └── 💻 net.exe (PID:1033) - SYSTEM [LOW]
                │   └── 💻 nginx.exe (PID:1020) - SYSTEM [LOW]
                └── 💻 [EXTEND] php-cgi.exe (PID:1011) - SYSTEM [MEDIUM]
                    ├── 💻 [EXTEND] nginx.exe (PID:1015) - SYSTEM [LOW]
                    │   └── 💻 [EXTEND] net.exe (PID:1027) - SYSTEM [LOW]
                    │       └── 💻 [EXTEND] reg.exe (PID:1045) - SYSTEM [LOW]
                    │           ├── 💻 sc.exe (PID:1072) - SYSTEM [LOW]
                    │           ├── 💻 sc.exe (PID:1079) - SYSTEM [LOW]
                    │           ├── 💻 sc.exe (PID:1084) - SYSTEM [LOW]
                    │           ├── 💻 sc.exe (PID:1088) - SYSTEM [LOW]
                    │           ├── 💻 sc.exe (PID:1090) - SYSTEM [LOW]
                    │           └── 💻 sc.exe (PID:1105) - SYSTEM [LOW]
                    └── 💻 [EXTEND] nginx.exe (PID:1016) - SYSTEM [LOW]
                        ├── 💻 [EXTEND] net.exe (PID:1025) - SYSTEM [LOW]
                        │   └── 💻 [EXTEND] reg.exe (PID:1046) - SYSTEM [LOW]
                        │       ├── 💻 sc.exe (PID:1063) - SYSTEM [LOW]
                        │       └── 💻 sc.exe (PID:1064) - SYSTEM [LOW]
                        ├── 💻 [EXTEND] net.exe (PID:1029) - SYSTEM [LOW]
                        │   ├── 💻 [EXTEND] reg.exe (PID:1044) - SYSTEM [LOW]
                        │   │   ├── 💻 sc.exe (PID:1078) - SYSTEM [LOW]
                        │   │   └── 💻 sc.exe (PID:1080) - SYSTEM [LOW]
                        │   └── 💻 [EXTEND] reg.exe (PID:1052) - SYSTEM [LOW]
                        │       └── 💻 sc.exe (PID:1077) - SYSTEM [LOW]
                        ├── 💻 [EXTEND] net.exe (PID:1030) - SYSTEM [LOW]
                        │   └── 💻 [EXTEND] reg.exe (PID:1037) - SYSTEM [LOW]
                        │       ├── 💻 sc.exe (PID:1073) - SYSTEM [LOW]
                        │       ├── 💻 sc.exe (PID:1094) - SYSTEM [LOW]
                        │       ├── 💻 sc.exe (PID:1095) - SYSTEM [LOW]
                        │       └── 💻 sc.exe (PID:1096) - SYSTEM [LOW]
                        └── 💻 [EXTEND] net.exe (PID:1031) - SYSTEM [LOW]
                            └── 💻 [EXTEND] reg.exe (PID:1049) - SYSTEM [LOW]
                                ├── 💻 sc.exe (PID:1055) - SYSTEM [LOW]
                                ├── 💻 sc.exe (PID:1059) - SYSTEM [LOW]
                                ├── 💻 sc.exe (PID:1076) - SYSTEM [LOW]
                                ├── 💻 sc.exe (PID:1083) - SYSTEM [LOW]
                                ├── 💻 sc.exe (PID:1097) - SYSTEM [LOW]
                                └── 💻 sc.exe (PID:1109) - SYSTEM [LOW]
```

### 统计信息

- **进程节点数**: 110
- **文件节点数**: 1
- **网络节点数**: 1
- **总节点数**: 112
- **根进程数**: 1
- **告警进程**: whoami.exe (PID:1000)
- **恶意文件**: evil.exe (unknown)

---

