# 案例5 - 命令执行攻击链关系图

## 基本信息
- **主机地址**: 10.50.117.200
- **攻击类型**: 命令执行
- **攻击描述**: 通用命令执行攻击
- **攻击源**: 10.50.86.155
- **攻击目标**: 10.50.117.200

- **根节点**: php-cgi.exe (process, processGuid: traceId-215)
- **总节点数**: 110

## 完整进程树

```
php-cgi.exe [traceId-215] (PID:1008)
├── cmd.exe [28703E5A45E1A14F] (PID:1002)
│   ├── powershell.exe [530E88B0A783A37E] (PID:1004)
│   │   └── php-cgi.exe [83698562D24DAA14] (PID:1014)
│   └── powershell.exe [E65B4E05A86E9601] (PID:1005)
│       └── php-cgi.exe [D7FF43731FA2A965] (PID:1012)
└── cmd.exe [B507EDE217144685] (PID:1003)
    ├── powershell.exe [13CE104B52691C72] (PID:1006)
    │   ├── php-cgi.exe [31C25B1D6BE8F57A] (PID:1010)
    │   │   ├── nginx.exe [D735C3C18B67DC70] (PID:1021)
    │   │   │   └── net.exe [2DE830D708F0BBD7] (PID:1024)
    │   │   │       ├── reg.exe [7E528C785037903C] (PID:1038)
    │   │   │       │   ├── sc.exe [479C2002A1AB4372] (PID:1087)
    │   │   │       │   ├── sc.exe [D63542118A6B2127] (PID:1098)
    │   │   │       │   └── sc.exe [6FF5E012AD408DA7] (PID:1106)
    │   │   │       ├── reg.exe [BB20B16A5231E35C] (PID:1039)
    │   │   │       │   ├── sc.exe [04307F35B7097606] (PID:1089)
    │   │   │       │   └── sc.exe [13C473D9E0E4D3AA] (PID:1091)
    │   │   │       ├── reg.exe [D9FCF949E715156C] (PID:1041)
    │   │   │       │   ├── sc.exe [CB42C565C1634158] (PID:1062)
    │   │   │       │   ├── sc.exe [107DD128437C62D1] (PID:1069)
    │   │   │       │   ├── sc.exe [81E5F3C0CDBC8B8C] (PID:1099)
    │   │   │       │   ├── sc.exe [BED0C8FD8F81CF59] (PID:1104)
    │   │   │       │   └── sc.exe [01155954698C41A1] (PID:1108)
    │   │   │       └── reg.exe [93ED90D255D60ED5] (PID:1051)
    │   │   └── nginx.exe [0EB080303429C62C] (PID:1023)
    │   │       └── net.exe [CC25F23E9AE1CA51] (PID:1036)
    │   └── php-cgi.exe [60771BC53ADC0C8F] (PID:1013)
    │       ├── nginx.exe [5283C92CB76619BD] (PID:1017)
    │       │   └── net.exe [A22DE95AC3BEBA2E] (PID:1035)
    │       │       ├── reg.exe [B0A72ED986502C0E] (PID:1043)
    │       │       │   ├── sc.exe [4D26FD0068575D45] (PID:1070)
    │       │       │   └── sc.exe [B3ED6E3BC3260534] (PID:1103)
    │       │       ├── reg.exe [4494BB614DECF49D] (PID:1047)
    │       │       │   ├── sc.exe [269F0914CE528B25] (PID:1057)
    │       │       │   ├── sc.exe [FF56908D3ED3A36B] (PID:1067)
    │       │       │   ├── sc.exe [F35339E20BE6E36E] (PID:1071)
    │       │       │   ├── sc.exe [2A0DC8E32484BD6D] (PID:1074)
    │       │       │   ├── sc.exe [A83636A3FFECDE38] (PID:1100)
    │       │       │   └── sc.exe [E2210F933B026079] (PID:1102)
    │       │       └── reg.exe [21E9649E0273A84D] (PID:1048)
    │       │           └── sc.exe [DCFCD11A7DFC1186] (PID:1101)
    │       ├── nginx.exe [3AC1E7A92F15D15B] (PID:1018)
    │       │   ├── net.exe [9DEEBD4F44158A44] (PID:1028)
    │       │   ├── net.exe [CCD0FA4A4CADE550] (PID:1032)
    │       │   └── net.exe [901E7FDE9454D5A4] (PID:1034)
    │       │       └── reg.exe [D0D7F65798C27B62] (PID:1042)
    │       │           ├── sc.exe [D46850EE8B39081F] (PID:1068)
    │       │           └── sc.exe [A462A0D5B3E350D0] (PID:1082)
    │       └── nginx.exe [6E9E616E06745BA5] (PID:1022)
    └── powershell.exe [73DB18DDB1726AC3] (PID:1007)
        ├── php-cgi.exe [traceId-215] (PID:1008)
        │   ├── cmd.exe [28703E5A45E1A14F] (PID:1002)
        │   │   ├── powershell.exe [530E88B0A783A37E] (PID:1004)
        │   │   │   └── php-cgi.exe [83698562D24DAA14] (PID:1014)
        │   │   └── powershell.exe [E65B4E05A86E9601] (PID:1005)
        │   │       └── php-cgi.exe [D7FF43731FA2A965] (PID:1012)
        ├── php-cgi.exe [96DFF235D18C1EBA] (PID:1009)
        │   ├── nginx.exe [B8C4AA2C9964E210] (PID:1019)
        │   │   ├── net.exe [0E193845DAA4CBC4] (PID:1026)
        │   │   │   ├── reg.exe [6DF96EB4CF80DC3F] (PID:1040)
        │   │   │   │   ├── sc.exe [140255A77A0DC6FB] (PID:1060)
        │   │   │   │   ├── sc.exe [A429928BC8700D5D] (PID:1065)
        │   │   │   │   ├── sc.exe [ED13BBF39553A5DA] (PID:1081)
        │   │   │   │   └── sc.exe [806E24D367646D2B] (PID:1085)
        │   │   │   ├── reg.exe [E1F01BCBC56D326F] (PID:1050)
        │   │   │   │   ├── sc.exe [16C1A55BEA1917E2] (PID:1056)
        │   │   │   │   ├── sc.exe [16B6779E5027794F] (PID:1061)
        │   │   │   │   ├── sc.exe [386E66634FF8E64F] (PID:1066)
        │   │   │   │   ├── sc.exe [6C80EFAE68E246E4] (PID:1075)
        │   │   │   │   └── sc.exe [4E4E2DC121292B24] (PID:1107)
        │   │   │   └── reg.exe [F4296FB1438201B0] (PID:1053)
        │   │   │       ├── sc.exe [19C33834BF6A05FD] (PID:1054)
        │   │   │       ├── sc.exe [2C3F899A29A35C74] (PID:1058)
        │   │   │       ├── sc.exe [BF7E2B3B834ACC72] (PID:1086)
        │   │   │       ├── sc.exe [994813D800283478] (PID:1092)
        │   │   │       └── sc.exe [D5CAFECABCB90C3E] (PID:1093)
        │   │   └── net.exe [B929FEDC045ED744] (PID:1033)
        │   └── nginx.exe [75CBC9A0112D0166] (PID:1020)
        └── php-cgi.exe [1753D1DCC7C2FDA2] (PID:1011)
            ├── nginx.exe [43399698D974F7A5] (PID:1015)
            │   └── net.exe [99AE311D33771F42] (PID:1027)
            │       └── reg.exe [060BE6042FCC854E] (PID:1045)
            │           ├── sc.exe [C4486C8998BE80AB] (PID:1072)
            │           ├── sc.exe [1695E775F46852FC] (PID:1079)
            │           ├── sc.exe [C0A421486960C557] (PID:1084)
            │           ├── sc.exe [F8E444424FE6663D] (PID:1088)
            │           ├── sc.exe [B54B98352B815C0E] (PID:1090)
            │           └── sc.exe [7F6AF34386C2D6E4] (PID:1105)
            └── nginx.exe [94F7B62D629FDEE0] (PID:1016)
                ├── net.exe [FA1DE7EB7D1DCB4E] (PID:1025)
                │   └── reg.exe [6215E5794E5D2C9A] (PID:1046)
                │       ├── sc.exe [CF07CDCCC74216EC] (PID:1063)
                │       └── sc.exe [50C3C698152B3731] (PID:1064)
                ├── net.exe [E2A7F31589706EFA] (PID:1029)
                │   ├── reg.exe [125A3084DE8A5A25] (PID:1044)
                │   │   ├── sc.exe [17E3F897B0EEC10D] (PID:1078)
                │   │   └── sc.exe [F192CAFB09833717] (PID:1080)
                │   └── reg.exe [5C4835172AE9469D] (PID:1052)
                │       └── sc.exe [0709D4B85242F589] (PID:1077)
                ├── net.exe [217736F7E6BC2DAB] (PID:1030)
                │   └── reg.exe [1309DC0218E7B8D6] (PID:1037)
                │       ├── sc.exe [4657C6D770548C1F] (PID:1073)
                │       ├── sc.exe [50129C3C48D17DDA] (PID:1094)
                │       ├── sc.exe [C0717FEB4A36F8C5] (PID:1095)
                │       └── sc.exe [F55418EFD9BB323E] (PID:1096)
                └── net.exe [993F7C064C36BFB4] (PID:1031)
                    └── reg.exe [1006EA172A5FD823] (PID:1049)
                        ├── sc.exe [9310453CA9C7833D] (PID:1055)
                        ├── sc.exe [9C1C820DB2CD238D] (PID:1059)
                        ├── sc.exe [9F3101CE474CDC8E] (PID:1076)
                        ├── sc.exe [1637C172099798DD] (PID:1083)
                        ├── sc.exe [B8FD5066FED0D193] (PID:1097)
                        └── sc.exe [485E4AD5190E1A67] (PID:1109)
```

## 统计信息

### 按进程类型统计:
- **sc.exe**: 56个实例
- **reg.exe**: 17个实例
- **net.exe**: 13个实例
- **nginx.exe**: 9个实例
- **php-cgi.exe**: 7个实例
- **powershell.exe**: 4个实例
- **cmd.exe**: 2个实例

## 说明
- 所有节点的 `hostAddress` 均为 10.50.117.200
- 根节点的 `processGuid` 等于 `traceId`
- 所有子节点通过 `parentProcessGuid` 字段连接到父节点的 `processGuid`
- 本图仅使用日志的**第一层级字段**生成，不解析 `otherFields` 等嵌套字段