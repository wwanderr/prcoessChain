# 案例5 - 命令执行攻击链关系图

## 基本信息
- **主机地址**: 10.50.117.200
- **攻击类型**: 命令执行
- **攻击描述**: 通用命令执行攻击
- **攻击源**: 10.50.86.155
- **攻击目标**: 10.50.117.200

- **根节点**: whoami.exe (file, processGuid: traceId-215)
- **总节点数**: 140

## 完整进程树

```
📄 whoami.exe [traceId-215] (文件日志)
├── cmd.exe [28703E5A45E1A14F] (PID:1002)
│   ├── powershell.exe [530E88B0A783A37E] (PID:1004)
│   │   └── php-cgi.exe [83698562D24DAA14] (PID:1014)
│   └── powershell.exe [E65B4E05A86E9601] (PID:1005)
│       └── php-cgi.exe [D7FF43731FA2A965] (PID:1012)
└── cmd.exe [B507EDE217144685] (PID:1003)
    └── powershell.exe [13CE104B52691C72] (PID:1006)
        ├── php-cgi.exe [31C25B1D6BE8F57A] (PID:1010)
        │   ├── nginx.exe [D735C3C18B67DC70] (PID:1021)
        │   │   ├── net.exe [2DE830D708F0BBD7] (PID:1024)
        │   │   │   ├── reg.exe [7E528C785037903C] (PID:1038)
        │   │   │   │   ├── sc.exe [479C2002A1AB4372] (PID:1087)
        │   │   │   │   ├── sc.exe [D63542118A6B2127] (PID:1098)
        │   │   │   │   └── sc.exe [6FF5E012AD408DA7] (PID:1106)
        │   │   │   ├── reg.exe [BB20B16A5231E35C] (PID:1039)
        │   │   │   │   ├── sc.exe [04307F35B7097606] (PID:1089)
        │   │   │   │   └── sc.exe [13C473D9E0E4D3AA] (PID:1091)
        │   │   │   ├── reg.exe [D9FCF949E715156C] (PID:1041)
        │   │   │   │   ├── sc.exe [CB42C565C1634158] (PID:1062)
        │   │   │   │   ├── sc.exe [107DD128437C62D1] (PID:1069)
        │   │   │   │   ├── sc.exe [81E5F3C0CDBC8B8C] (PID:1099)
        │   │   │   │   ├── sc.exe [BED0C8FD8F81CF59] (PID:1104)
        │   │   │   │   └── sc.exe [01155954698C41A1] (PID:1108)
        │   │   │   └── reg.exe [93ED90D255D60ED5] (PID:1051)
        │   │   ├── net.exe [NET070BB323BF] (PID:2006)
        │   │   ├── net.exe [NET161E5516A5] (PID:2015)
        │   │   ├── net.exe [NET028B67DC70] (PID:2003)
        │   │   ├── net.exe [NET078B67DC70] (PID:2008)
        │   │   ├── net.exe [NET128B67DC70] (PID:2013)
        │   │   └── net.exe [NET178B67DC70] (PID:2018)
        │   └── nginx.exe [0EB080303429C62C] (PID:1023)
        │       ├── net.exe [CC25F23E9AE1CA51] (PID:1036)
        │       ├── net.exe [NET090E2E2575] (PID:2008)
        │       ├── net.exe [NET18154F198A] (PID:2017)
        │       ├── net.exe [NET043429C62C] (PID:2005)
        │       ├── net.exe [NET093429C62C] (PID:2010)
        │       ├── net.exe [NET143429C62C] (PID:2015)
        │       └── net.exe [NET193429C62C] (PID:2020)
        └── php-cgi.exe [60771BC53ADC0C8F] (PID:1013)
            ├── nginx.exe [5283C92CB76619BD] (PID:1017)
            │   ├── net.exe [A22DE95AC3BEBA2E] (PID:1035)
            │   │   ├── reg.exe [B0A72ED986502C0E] (PID:1043)
            │   │   │   ├── sc.exe [4D26FD0068575D45] (PID:1070)
            │   │   │   └── sc.exe [B3ED6E3BC3260534] (PID:1103)
            │   │   ├── reg.exe [4494BB614DECF49D] (PID:1047)
            │   │   │   ├── sc.exe [269F0914CE528B25] (PID:1057)
            │   │   │   ├── sc.exe [FF56908D3ED3A36B] (PID:1067)
            │   │   │   ├── sc.exe [F35339E20BE6E36E] (PID:1071)
            │   │   │   ├── sc.exe [2A0DC8E32484BD6D] (PID:1074)
            │   │   │   ├── sc.exe [A83636A3FFECDE38] (PID:1100)
            │   │   │   └── sc.exe [E2210F933B026079] (PID:1102)
            │   │   └── reg.exe [21E9649E0273A84D] (PID:1048)
            │   │       └── sc.exe [DCFCD11A7DFC1186] (PID:1101)
            │   ├── net.exe [NET0325781AB9] (PID:2002)
            │   ├── net.exe [NET1217A116E7] (PID:2011)
            │   ├── net.exe [NET00B76619BD] (PID:2001)
            │   ├── net.exe [NET05B76619BD] (PID:2006)
            │   ├── net.exe [NET10B76619BD] (PID:2011)
            │   └── net.exe [NET15B76619BD] (PID:2016)
            ├── nginx.exe [3AC1E7A92F15D15B] (PID:1018)
            │   ├── net.exe [9DEEBD4F44158A44] (PID:1028)
            │   ├── net.exe [CCD0FA4A4CADE550] (PID:1032)
            │   ├── net.exe [901E7FDE9454D5A4] (PID:1034)
            │   │   └── reg.exe [D0D7F65798C27B62] (PID:1042)
            │   │       ├── sc.exe [D46850EE8B39081F] (PID:1068)
            │   │       └── sc.exe [A462A0D5B3E350D0] (PID:1082)
            │   ├── net.exe [NET040A841F83] (PID:2003)
            │   ├── net.exe [NET1318140E81] (PID:2012)
            │   ├── net.exe [NET012F15D15B] (PID:2002)
            │   ├── net.exe [NET062F15D15B] (PID:2007)
            │   ├── net.exe [NET112F15D15B] (PID:2012)
            │   └── net.exe [NET162F15D15B] (PID:2017)
            └── nginx.exe [6E9E616E06745BA5] (PID:1022)
                ├── net.exe [NET081CE70F3E] (PID:2007)
                ├── net.exe [NET170AAB1C44] (PID:2016)
                ├── net.exe [NET0306745BA5] (PID:2004)
                ├── net.exe [NET0806745BA5] (PID:2009)
                ├── net.exe [NET1306745BA5] (PID:2014)
                └── net.exe [NET1806745BA5] (PID:2019)
```

## 统计信息

### 按进程类型统计:
- **sc.exe**: 56个实例
- **net.exe**: 43个实例
- **reg.exe**: 17个实例
- **nginx.exe**: 9个实例
- **php-cgi.exe**: 7个实例
- **powershell.exe**: 4个实例
- **cmd.exe**: 2个实例
- **svchost.exe**: 1个实例

## 说明
- 所有节点的 `hostAddress` 均为 10.50.117.200
- 根节点的 `processGuid` 等于 `traceId`
- 所有子节点通过 `parentProcessGuid` 字段连接到父节点的 `processGuid`
- 本图仅使用日志的**第一层级字段**生成，不解析 `otherFields` 等嵌套字段