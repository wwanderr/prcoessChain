# 案例4 - 命令执行攻击链关系图

## 基本信息
- **主机地址**: 10.50.116.199
- **攻击类型**: 命令执行
- **攻击描述**: 通用命令执行攻击
- **攻击源**: 10.50.86.154
- **攻击目标**: 10.50.116.199

- **根节点**: php-cgi.exe (process, processGuid: traceId-214)
- **总节点数**: 35

## 完整进程树

```
php-cgi.exe [traceId-214] (PID:1015)
├── cmd.exe [9FC2A8AC7BD82C3A] (PID:1005)
│   └── powershell.exe [6F0274EBA17B7399] (PID:1010)
│       └── php-cgi.exe [traceId-214] (PID:1015)
│           ├── cmd.exe [63959BFBAA00339F] (PID:1006)
│           │   └── powershell.exe [A7EEC5CF4E03C8AC] (PID:1011)
│           │       └── php-cgi.exe [DEA42B032C272FC2] (PID:1016)
│           │           └── nginx.exe [30B3952B7B2A5778] (PID:1021)
│           │               └── net.exe [41791FA04EE0E81B] (PID:1026)
│           │                   └── reg.exe [94DF76566D7E2329] (PID:1031)
│           ├── cmd.exe [D3FDD132EEE8FF59] (PID:1007)
│           │   └── powershell.exe [EC44EC3A6ED89B5A] (PID:1012)
│           │       └── php-cgi.exe [EB9AE04E0EB67C23] (PID:1017)
│           │           └── nginx.exe [9FF305E27F1C295F] (PID:1022)
│           │               └── net.exe [66326CBC7C3494F7] (PID:1027)
│           │                   └── reg.exe [35543125C385C190] (PID:1032)
│           ├── cmd.exe [77F87B4409AE9C29] (PID:1008)
│           │   └── powershell.exe [79708C8329BC3C67] (PID:1013)
│           │       └── php-cgi.exe [F1E84FF94BF23C37] (PID:1018)
│           │           └── nginx.exe [D12ED986D2343366] (PID:1023)
│           │               └── net.exe [37778B0964A9B0C6] (PID:1028)
│           │                   └── reg.exe [29C5C3720E6CFE62] (PID:1033)
│           └── cmd.exe [7FA68E30780FDF2E] (PID:1009)
│               └── powershell.exe [33F1A654CA083D85] (PID:1014)
│                   └── php-cgi.exe [297026C8DF11E4B9] (PID:1019)
│                       └── nginx.exe [75A4E706E808076C] (PID:1024)
│                           └── net.exe [142C788FF85480E2] (PID:1029)
│                               └── reg.exe [4E33193CD14DEDB7] (PID:1034)
├── cmd.exe [63959BFBAA00339F] (PID:1006)
│   └── powershell.exe [A7EEC5CF4E03C8AC] (PID:1011)
│       └── php-cgi.exe [DEA42B032C272FC2] (PID:1016)
│           └── nginx.exe [30B3952B7B2A5778] (PID:1021)
│               └── net.exe [41791FA04EE0E81B] (PID:1026)
│                   └── reg.exe [94DF76566D7E2329] (PID:1031)
├── cmd.exe [D3FDD132EEE8FF59] (PID:1007)
│   └── powershell.exe [EC44EC3A6ED89B5A] (PID:1012)
│       └── php-cgi.exe [EB9AE04E0EB67C23] (PID:1017)
│           └── nginx.exe [9FF305E27F1C295F] (PID:1022)
│               └── net.exe [66326CBC7C3494F7] (PID:1027)
│                   └── reg.exe [35543125C385C190] (PID:1032)
├── cmd.exe [77F87B4409AE9C29] (PID:1008)
│   └── powershell.exe [79708C8329BC3C67] (PID:1013)
│       └── php-cgi.exe [F1E84FF94BF23C37] (PID:1018)
│           └── nginx.exe [D12ED986D2343366] (PID:1023)
│               └── net.exe [37778B0964A9B0C6] (PID:1028)
│                   └── reg.exe [29C5C3720E6CFE62] (PID:1033)
└── cmd.exe [7FA68E30780FDF2E] (PID:1009)
    └── powershell.exe [33F1A654CA083D85] (PID:1014)
        └── php-cgi.exe [297026C8DF11E4B9] (PID:1019)
            └── nginx.exe [75A4E706E808076C] (PID:1024)
                └── net.exe [142C788FF85480E2] (PID:1029)
                    └── reg.exe [4E33193CD14DEDB7] (PID:1034)
```

## 统计信息

### 按进程类型统计:
- **cmd.exe**: 5个实例
- **powershell.exe**: 5个实例
- **php-cgi.exe**: 5个实例
- **nginx.exe**: 5个实例
- **net.exe**: 5个实例
- **reg.exe**: 5个实例

## 说明
- 所有节点的 `hostAddress` 均为 10.50.116.199
- 根节点的 `processGuid` 等于 `traceId`
- 所有子节点通过 `parentProcessGuid` 字段连接到父节点的 `processGuid`
- 本图仅使用日志的**第一层级字段**生成，不解析 `otherFields` 等嵌套字段