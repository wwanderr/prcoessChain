# å®ä½“å­—æ®µéªŒè¯æµ‹è¯•æ•°æ®è¯´æ˜

## ğŸ“‹ æ¦‚è¿°

æœ¬æµ‹è¯•æ•°æ®æ–‡ä»¶ `test_data_full_entity.txt` ä¸“é—¨ç”¨äºéªŒè¯å®ä½“è½¬æ¢çš„æ‰€æœ‰æ–°å¢åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š
- âœ… å®ä½“å­—æ®µé»˜è®¤å€¼åˆå§‹åŒ–ä¸ºç©ºå­—ç¬¦ä¸²
- âœ… alarmResults æ˜ å°„ï¼ˆOKâ†’æˆåŠŸã€FAILâ†’å¤±è´¥ã€UNKNOWNâ†’å°è¯•ï¼‰
- âœ… fileType æšä¸¾è½¬ä¸­æ–‡
- âœ… fileSize è½¬æ¢ä¸º MB æ ¼å¼
- âœ… processName é»˜è®¤å€¼å¤„ç†
- âœ… RegistryEntity æ–°å¢ targetObjectName å­—æ®µ

## ğŸ” æµ‹è¯•æ•°æ®ç»“æ„

### æ•°æ®è¡Œè¯´æ˜

æ–‡ä»¶å…± **14 è¡Œæ•°æ®**ï¼ŒåŒ…å«ï¼š

1. **ç¬¬ 1 è¡Œ**ï¼šç½‘ä¾§å‘Šè­¦æ•°æ® (logType=alert)
2. **ç¬¬ 2-14 è¡Œ**ï¼šç«¯ä¾§æ—¥å¿—æ•°æ®ï¼Œè¦†ç›–æ‰€æœ‰å®ä½“ç±»å‹

### IP åœ°å€æ›¿æ¢

- **åŸæ¡ˆä¾‹1 IP**: `10.50.122.205` å’Œ `10.50.86.150`
- **æ–°æµ‹è¯•æ•°æ® IP**: `10.50.125.210` å’Œ `10.50.88.160`
- **traceId**: `traceId-301`ï¼ˆåŒºåˆ«äºåŸæ•°æ®çš„ `traceId-211`ï¼‰

---

## ğŸ“Š è¯¦ç»†æ•°æ®æ¸…å•

### 1ï¸âƒ£ ç½‘ä¾§å‘Šè­¦ (logType=alert)

**æµ‹è¯•ç›®çš„**: éªŒè¯ AlarmNodeInfo å®ä½“çš„ alarmResults æ˜ å°„

| å­—æ®µ | å€¼ | éªŒè¯ç‚¹ |
|------|-----|--------|
| logType | alert | å‘Šè­¦ç±»å‹ |
| opType | connect | ç½‘ç»œè¿æ¥æ“ä½œ |
| severity | 7 | é«˜å±ç­‰çº§ |
| **alarmResults** | **OK** | **åº”æ˜ å°„ä¸º"æˆåŠŸ"** |
| dvcAction | é˜»æ–­ | è®¾å¤‡åŠ¨ä½œ |
| alarmDescription | æ£€æµ‹åˆ°å‘½ä»¤æ‰§è¡Œæ”»å‡»è¡Œä¸º | å‘Šè­¦æè¿° |
| alarmSource | APTé¢„è­¦ç³»ç»Ÿ | å‘Šè­¦æ¥æº |
| srcAddress | 10.50.88.160 | æ”»å‡»æº |
| destAddress | 10.50.125.210 | å—å®³è€… |

---

### 2ï¸âƒ£ Process å®ä½“ - cmd.exe (logType=process, opType=create)

**æµ‹è¯•ç›®çš„**: éªŒè¯è¿›ç¨‹å®ä½“åŸºæœ¬å­—æ®µ

| å­—æ®µ | å€¼ |
|------|-----|
| processName | cmd.exe |
| image | C:\\Windows\\System32\\cmd.exe |
| commandLine | cmd.exe /c "ping 10.50.125.211;whoami" |
| processId | 8024 |
| processGuid | 3165C0FB1048A159 |
| processMd5 | 2b40c98ed0f7a1d3b091a3e8353132dc |
| processUserName | DESKTOP-M0S0L3H\\Administrator |

---

### 3ï¸âƒ£ Process å®ä½“ - whoami.exe (logType=process, opType=create)

**æµ‹è¯•ç›®çš„**: éªŒè¯å­è¿›ç¨‹å®ä½“

| å­—æ®µ | å€¼ |
|------|-----|
| processName | whoami.exe |
| image | C:\\Windows\\System32\\whoami.exe |
| commandLine | whoami |
| processId | 4696 |
| parentProcessId | 8024 |
| parentProcessGuid | 3165C0FB1048A159 |

---

### 4ï¸âƒ£ File å®ä½“ - PE æ–‡ä»¶ (logType=file, opType=create)

**æµ‹è¯•ç›®çš„**: éªŒè¯ fileType=pe æ˜ å°„å’Œ fileSize è½¬æ¢

| å­—æ®µ | åŸå§‹å€¼ | é¢„æœŸè¾“å‡º |
|------|--------|----------|
| fileName | suspicious_file.exe | suspicious_file.exe |
| filePath | C:\\Users\\Administrator\\Desktop\\malware\\suspicious_file.exe | (åŸå€¼) |
| **fileSize** | **19969668** (å­—èŠ‚) | **19.97MB** |
| **fileType** | **pe** | **å¯ç§»æ¤å¯æ‰§è¡Œæ–‡ä»¶** |
| fileMd5 | d41d8cd98f00b204e9800998ecf8427e | (åŸå€¼) |
| processName | whoami.exe | whoami.exe |

---

### 5ï¸âƒ£ File å®ä½“ - Text æ–‡ä»¶ (logType=file, opType=write)

**æµ‹è¯•ç›®çš„**: éªŒè¯ fileType=text æ˜ å°„å’Œå°æ–‡ä»¶ fileSize è½¬æ¢

| å­—æ®µ | åŸå§‹å€¼ | é¢„æœŸè¾“å‡º |
|------|--------|----------|
| fileName | config.ini | config.ini |
| **fileSize** | **2048** (å­—èŠ‚) | **0.00MB** |
| **fileType** | **text** | **æ–‡æœ¬æ–‡ä»¶** |
| processName | notepad.exe | notepad.exe |

---

### 6ï¸âƒ£ File å®ä½“ - åˆ é™¤æ“ä½œ (logType=file, opType=delete)

**æµ‹è¯•ç›®çš„**: éªŒè¯æ–‡ä»¶åˆ é™¤æ—¶è¾¹çš„ val ä¸ºç©ºå­—ç¬¦ä¸²ï¼ˆè™šçº¿ï¼‰

| å­—æ®µ | åŸå§‹å€¼ | é¢„æœŸè¾“å‡º |
|------|--------|----------|
| fileName | old_file.txt | old_file.txt |
| **opType** | **delete** | **delete** |
| **fileSize** | **512000** (å­—èŠ‚) | **0.49MB** |
| **fileType** | **text** | **æ–‡æœ¬æ–‡ä»¶** |
| processName | cmd.exe | cmd.exe |

**è¾¹çš„ val å€¼**: åº”ä¸º `""` (ç©ºå­—ç¬¦ä¸²)ï¼Œè¡¨ç¤ºè™šçº¿

---

### 7ï¸âƒ£ Network å®ä½“ (logType=network, opType=connect)

**æµ‹è¯•ç›®çš„**: éªŒè¯ç½‘ç»œè¿æ¥å®ä½“

| å­—æ®µ | å€¼ |
|------|-----|
| srcAddress | 10.50.125.210 |
| destAddress | 8.8.8.8 |
| srcPort | 52341 |
| destPort | 443 |
| transProtocol | TCP |
| initiated | true |
| processName | chrome.exe |

---

### 8ï¸âƒ£ Domain å®ä½“ (logType=domain, opType=query)

**æµ‹è¯•ç›®çš„**: éªŒè¯åŸŸåæŸ¥è¯¢å®ä½“

| å­—æ®µ | å€¼ |
|------|-----|
| requestDomain | malicious-c2-server.evil.com |
| queryResults | SUCCESS |
| processName | chrome.exe |

---

### 9ï¸âƒ£ Registry å®ä½“ (logType=registry, opType=setValue)

**æµ‹è¯•ç›®çš„**: éªŒè¯æ³¨å†Œè¡¨å®ä½“å’Œ targetObjectName æå–

| å­—æ®µ | åŸå§‹å€¼ | é¢„æœŸè¾“å‡º |
|------|--------|----------|
| **targetObject** | HKU\\S-1-5-21-1309279535-3785507593-3179266732-1000\\Software\\Microsoft\\Internet Explorer\\Toolbar\\**Locked** | (åŸå€¼) |
| **targetObjectName** | - | **Locked** (æå–æœ€åä¸€å±‚) |
| regValue | DWORD:0x00000001 | (åŸå€¼) |
| processName | reg.exe | reg.exe |

---

### ğŸ”Ÿ File å®ä½“ - ELF ç±»å‹ (logType=file, opType=create)

**æµ‹è¯•ç›®çš„**: éªŒè¯ fileType=elf æ˜ å°„

| å­—æ®µ | åŸå§‹å€¼ | é¢„æœŸè¾“å‡º |
|------|--------|----------|
| fileName | malicious_script.py | malicious_script.py |
| **fileSize** | **5242880** (å­—èŠ‚) | **5.00MB** |
| **fileType** | **elf** | **å¯æ‰§è¡Œä¸å¯é“¾æ¥æ ¼å¼** |
| image | /usr/bin/python3 | (åŸå€¼) |
| processUserName | root | root |

---

### 1ï¸âƒ£1ï¸âƒ£ File å®ä½“ - LNK å¿«æ·æ–¹å¼ (logType=file, opType=create)

**æµ‹è¯•ç›®çš„**: éªŒè¯ fileType=lnk æ˜ å°„

| å­—æ®µ | åŸå§‹å€¼ | é¢„æœŸè¾“å‡º |
|------|--------|----------|
| fileName | shortcut_to_malware.lnk | shortcut_to_malware.lnk |
| **fileSize** | **1024** (å­—èŠ‚) | **0.00MB** |
| **fileType** | **lnk** | **å¿«æ·æ–¹å¼æ–‡ä»¶** |
| processName | explorer.exe | explorer.exe |

---

### 1ï¸âƒ£2ï¸âƒ£ File å®ä½“ - Script è„šæœ¬ (logType=file, opType=create)

**æµ‹è¯•ç›®çš„**: éªŒè¯ fileType=script æ˜ å°„

| å­—æ®µ | åŸå§‹å€¼ | é¢„æœŸè¾“å‡º |
|------|--------|----------|
| fileName | download_payload.ps1 | download_payload.ps1 |
| **fileSize** | **8192** (å­—èŠ‚) | **0.01MB** |
| **fileType** | **script** | **è„šæœ¬æ–‡ä»¶** |
| processName | powershell.exe | powershell.exe |

---

### 1ï¸âƒ£3ï¸âƒ£ File å®ä½“ - Archive å‹ç¼©æ–‡ä»¶ (logType=file, opType=create)

**æµ‹è¯•ç›®çš„**: éªŒè¯ fileType=archive æ˜ å°„å’Œå¤§æ–‡ä»¶ fileSize è½¬æ¢

| å­—æ®µ | åŸå§‹å€¼ | é¢„æœŸè¾“å‡º |
|------|--------|----------|
| fileName | stolen_data.zip | stolen_data.zip |
| **fileSize** | **104857600** (å­—èŠ‚ï¼Œ100MB) | **100.00MB** |
| **fileType** | **archive** | **å‹ç¼©/å½’æ¡£æ–‡ä»¶** |
| processName | 7z.exe | 7z.exe |

---

### 1ï¸âƒ£4ï¸âƒ£ Process å®ä½“ - processName ä¸ºç©ºæµ‹è¯• (logType=process, opType=create)

**æµ‹è¯•ç›®çš„**: éªŒè¯ processName ä¸ºç©ºæ—¶é»˜è®¤ä¸º "è¿›ç¨‹.exe"

| å­—æ®µ | åŸå§‹å€¼ | é¢„æœŸè¾“å‡º |
|------|--------|----------|
| **processName** | **(ç¼ºå¤±)** | **"è¿›ç¨‹.exe"** |
| image | C:\\Windows\\System32\\unknown_process.exe | (åŸå€¼) |
| commandLine | unknown_process.exe --hidden | (åŸå€¼) |
| processId | 11264 | (åŸå€¼) |

---

## âœ… éªŒè¯æ£€æŸ¥æ¸…å•

### AlarmNodeInfo å®ä½“
- [ ] alarmResults = "OK" â†’ è¾“å‡º "æˆåŠŸ"
- [ ] dvcAction å­—æ®µæ­£å¸¸å¡«å……
- [ ] alarmDescription å­—æ®µæ­£å¸¸å¡«å……
- [ ] alarmSource å­—æ®µæ­£å¸¸å¡«å……
- [ ] å…¶ä»–å­—æ®µé»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²

### ProcessEntity å®ä½“
- [ ] logType=process æ—¶ï¼ŒprocessName ä¸ºç©º â†’ "è¿›ç¨‹.exe"
- [ ] æ‰€æœ‰å­—æ®µé»˜è®¤åˆå§‹åŒ–ä¸ºç©ºå­—ç¬¦ä¸²
- [ ] opType å­—æ®µæ­£ç¡®è·å–

### FileEntity å®ä½“
- [ ] fileType æ­£ç¡®æ˜ å°„ä¸ºä¸­æ–‡ï¼š
  - pe â†’ å¯ç§»æ¤å¯æ‰§è¡Œæ–‡ä»¶
  - elf â†’ å¯æ‰§è¡Œä¸å¯é“¾æ¥æ ¼å¼
  - text â†’ æ–‡æœ¬æ–‡ä»¶
  - lnk â†’ å¿«æ·æ–¹å¼æ–‡ä»¶
  - script â†’ è„šæœ¬æ–‡ä»¶
  - archive â†’ å‹ç¼©/å½’æ¡£æ–‡ä»¶
- [ ] fileSize æ­£ç¡®è½¬æ¢ä¸º MB æ ¼å¼ï¼ˆä¿ç•™2ä½å°æ•°ï¼‰ï¼š
  - 19969668 â†’ 19.97MB
  - 2048 â†’ 0.00MB
  - 5242880 â†’ 5.00MB
  - 104857600 â†’ 100.00MB
- [ ] opType=delete æ—¶ï¼Œè¾¹çš„ val="" (è™šçº¿)
- [ ] æ‰€æœ‰å­—æ®µé»˜è®¤åˆå§‹åŒ–ä¸ºç©ºå­—ç¬¦ä¸²

### NetworkEntity å®ä½“
- [ ] transProtocolã€srcAddressã€destAddress æ­£ç¡®å¡«å……
- [ ] srcPortã€destPort ä¸º Integer ç±»å‹
- [ ] initiated ä¸º Boolean ç±»å‹
- [ ] æ‰€æœ‰å­—ç¬¦ä¸²å­—æ®µé»˜è®¤åˆå§‹åŒ–ä¸ºç©ºå­—ç¬¦ä¸²

### DomainEntity å®ä½“
- [ ] requestDomainã€queryResults æ­£ç¡®å¡«å……
- [ ] æ‰€æœ‰å­—æ®µé»˜è®¤åˆå§‹åŒ–ä¸ºç©ºå­—ç¬¦ä¸²

### RegistryEntity å®ä½“
- [ ] targetObject å®Œæ•´è·¯å¾„æ­£ç¡®å¡«å……
- [ ] targetObjectName æ­£ç¡®æå–æœ€åä¸€å±‚ï¼š
  - è¾“å…¥ï¼š`HKU\\S-1-5-21...\\Toolbar\\Locked`
  - è¾“å‡ºï¼š`Locked`
- [ ] regValue æ­£ç¡®å¡«å……
- [ ] æ‰€æœ‰å­—æ®µé»˜è®¤åˆå§‹åŒ–ä¸ºç©ºå­—ç¬¦ä¸²

### ProcessEdge è¾¹
- [ ] é»˜è®¤ val = "è¿æ¥"
- [ ] logType=file ä¸” opType=delete æ—¶ï¼Œval = "" (è™šçº¿)

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

1. å°† `test_data_full_entity.txt` å¯¼å…¥ ES ç´¢å¼•
2. ä½¿ç”¨ traceId=`traceId-301` è°ƒç”¨è¿›ç¨‹é“¾æ„å»º API
3. æ£€æŸ¥è¿”å›çš„ JSON ä¸­å„å®ä½“å­—æ®µæ˜¯å¦ç¬¦åˆé¢„æœŸ
4. å¯¹ç…§ä¸Šè¿°æ£€æŸ¥æ¸…å•é€é¡¹éªŒè¯

---

## ğŸ“ å¤‡æ³¨

- æ‰€æœ‰æ—¶é—´æˆ³åŸºäº 2025-05-26 13:20:00 å¼€å§‹ï¼Œæ¯æ¡è®°å½•é€’å¢ 1 ç§’
- æ‰€æœ‰æ•°æ®å±äºåŒä¸€ traceIdï¼Œå¯å½¢æˆå®Œæ•´çš„è¿›ç¨‹é“¾
- hostAddress ç»Ÿä¸€ä¸º `10.50.125.210`
- machineCode ç»Ÿä¸€ä¸º `88313ab3e10488fd393322f89b617639cb29f90e5594b6a6b278718cccdba0b5`

