# 案例5 - Webshell文件上传攻击链关系图

## 基本信息
- **主机地址**: 10.50.113.196
- **攻击类型**: Webshell文件上传
- **攻击工具**: 冰蝎(Behinder) Webshell
- **根节点**: php-cgi.exe (file, processGuid: traceId-989)
- **总节点数**: 66

## 完整进程树

```
📄 php-cgi.exe [traceId-989] (文件日志)
└── xp.cn_cgi.exe [4EFA4DBDCD7A9807] (PID:1001)
    ├── phpstudy_pro.exe [DF2220973F2AB8B8] (PID:1005)
    │   └── apache.exe [96440ECFFDD8D1CC] (PID:1013)
    ├── phpstudy_pro.exe [CCADDD4C4A756CB0] (PID:1006)
    └── phpstudy_pro.exe [9F3369C56559831A] (PID:1007)
        ├── apache.exe [A9E74BB7E94D691D] (PID:1009)
        │   ├── nginx.exe [E0B4E9B56053CBDB] (PID:1017)
        │   │   └── RuntimeBroker.exe [666FB7F2A5688177] (PID:1030)
        │   └── nginx.exe [FFF72EA178990BDC] (PID:1024)
        │       ├── RuntimeBroker.exe [92427AF9841C24CF] (PID:1034)
        │       └── RuntimeBroker.exe [EBE3508515B3A1D3] (PID:1037)
        │           ├── svchost.exe [93967778E2877170] (PID:1049)
        │           │   ├── services.exe [8C3345E304A0EE90] (PID:1068)
        │           │   ├── services.exe [C6611DADF720D697] (PID:1077)
        │           │   ├── services.exe [8DD25D800A78D614] (PID:1092)
        │           │   └── services.exe [BFCD278ECFFD7343] (PID:1096)
        │           └── svchost.exe [21135BF6416D181E] (PID:1057)
        │               ├── services.exe [312A3ED67B3CF7EB] (PID:1061)
        │               ├── services.exe [5C1FB002A038E587] (PID:1085)
        │               └── services.exe [9882B2FB9B8D83DC] (PID:1099)
        ├── apache.exe [60CC1CE6B644DE37] (PID:1012)
        │   └── nginx.exe [47DE3F7861E17624] (PID:1018)
        │       ├── RuntimeBroker.exe [FF60F5625903D34E] (PID:1026)
        │       └── RuntimeBroker.exe [09DBCBDA78B9E491] (PID:1029)
        │           └── svchost.exe [E7B78E61C6C480F1] (PID:1046)
        │               └── services.exe [062103CD32222235] (PID:1063)
        └── apache.exe [25B45D5EBFBE9F95] (PID:1014)
            ├── nginx.exe [AD923438059C57E6] (PID:1016)
            │   ├── RuntimeBroker.exe [70E769E8FFC94543] (PID:1038)
            │   │   ├── svchost.exe [0C32517110E14086] (PID:1041)
            │   │   │   ├── services.exe [E91293B1A554B39E] (PID:1069)
            │   │   │   ├── services.exe [8C4F7B5BC9F7998A] (PID:1073)
            │   │   │   ├── services.exe [78EFEDF6DE4AEEFB] (PID:1095)
            │   │   │   ├── services.exe [DC085965C85B4937] (PID:1102)
            │   │   │   ├── services.exe [4FEB24B7BC1D612D] (PID:1108)
            │   │   │   └── services.exe [BCFEDDADC6224BBB] (PID:1111)
            │   │   ├── svchost.exe [17CA041B4AD2D45B] (PID:1042)
            │   │   │   ├── services.exe [378F3FD11378F841] (PID:1070)
            │   │   │   └── services.exe [2E69C7AF430F0670] (PID:1110)
            │   │   └── svchost.exe [E03C2D95DE00D7DA] (PID:1056)
            │   │       ├── services.exe [7D07AD3230106BF2] (PID:1066)
            │   │       ├── services.exe [11636BBED2A42AF4] (PID:1072)
            │   │       ├── services.exe [63FEEE102ADAFBDA] (PID:1078)
            │   │       ├── services.exe [C6BFF4EE9833A117] (PID:1082)
            │   │       ├── services.exe [B727FFC81804C586] (PID:1112)
            │   │       └── services.exe [D06F4AB1227097C8] (PID:1119)
            │   └── RuntimeBroker.exe [BD42B06B3B9D6A8A] (PID:1039)
            ├── nginx.exe [CA7994A8FCFB9983] (PID:1021)
            └── nginx.exe [09BCEFA530062D61] (PID:1025)
                ├── RuntimeBroker.exe [BBA803AD3885DA12] (PID:1032)
                │   └── svchost.exe [020B5D090AE23284] (PID:1053)
                │       ├── services.exe [2CD37799B9EAE31D] (PID:1060)
                │       ├── services.exe [1686528FDAD1FF84] (PID:1067)
                │       └── services.exe [0E0AAECDC1BFB39F] (PID:1104)
                └── RuntimeBroker.exe [9CB4E1049BC84AE7] (PID:1035)
                    ├── svchost.exe [C52F6366E3889993] (PID:1051)
                    │   ├── services.exe [0AA318BC72387D59] (PID:1064)
                    │   ├── services.exe [9CB2CD5083C48A61] (PID:1080)
                    │   ├── services.exe [E1CC6D9DEBC35015] (PID:1089)
                    │   ├── services.exe [EB1080D82C1A2C35] (PID:1097)
                    │   ├── services.exe [91D80EECB18CA5C7] (PID:1107)
                    │   └── services.exe [1D7E25C3CDF3EF59] (PID:1115)
                    └── svchost.exe [0FF80405CB320055] (PID:1052)
                        ├── services.exe [4E3EC0C419629DCF] (PID:1059)
                        └── services.exe [1D7E85083B285A16] (PID:1094)
```

## 统计信息

### 按进程类型统计:
- **services.exe**: 33个实例
- **RuntimeBroker.exe**: 9个实例
- **svchost.exe**: 9个实例
- **nginx.exe**: 6个实例
- **apache.exe**: 4个实例
- **phpstudy_pro.exe**: 3个实例
- **xp.cn_cgi.exe**: 1个实例

## 说明
- 所有节点的 `hostAddress` 均为 10.50.113.196
- 根节点的 `processGuid` 等于 `traceId`
- 所有子节点通过 `parentProcessGuid` 字段连接到父节点的 `processGuid`
- 本图仅使用日志的**第一层级字段**生成，不解析 `otherFields` 等嵌套字段