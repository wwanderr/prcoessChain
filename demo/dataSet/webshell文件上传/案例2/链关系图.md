# Webshell文件上传 - 案例2 - 攻击链关系图

## ⭐ 根节点标注
- **根节点**: xp.cn_cgi.exe (PID: 3040)
- **告警类型**: Webshell文件上传
- **主机地址**: 10.50.110.193

## 完整攻击链结构图

### 进程链树状图

```
🌐 [NETWORK-ALERT] 检测到上传冰蝎webshell文件(PHP)
   来源: 10.50.86.151:51344 → 目的: 10.50.110.193:80 (HTTP/TCP)
   严重性: HIGH (7)
   └── 💻 [EXTEND] RuntimeBroker.exe (PID:424, Administrator) [traceId: traceId-grandpa-C98F16A7] ⬆️ 祖父节点
       └── 💻 [EXTEND] phpstudy_pro.exe (PID:6992, Administrator) [traceId: traceId-parent-C46B2112] ⬆️ 父节点
           └── 🚨 [ROOT,ALARM] xp.cn_cgi.exe (PID:3040, Administrator) [traceId: A85889BAF0885BE9] ⭐根节点
```

### 文件操作事件

```
📄 [FILE-CREATE] 发现Backdoor/PHP.WebShell.ek病毒文件创建
   文件名: bello.php
   路径: C:\phpstudy_pro\WWW\pika\vul\unsafeupload\uploads\bello.php
   病毒类型: Backdoor/PHP.WebShell.ek
   严重性: HIGH (7)
   创建进程: php-cgi.exe (PID:228) [断链 - 无process日志]
   traceId: A85889BAF0885BE9
```

## 攻击链分析

### traceId分层结构
- **祖父节点**: RuntimeBroker.exe (traceId: traceId-grandpa-C98F16A7)
- **父节点**: phpstudy_pro.exe (traceId: traceId-parent-C46B2112)
- **根节点**: xp.cn_cgi.exe (traceId: A85889BAF0885BE9)
- **后代节点**: 无

### 网络连接规则
网络攻击流量连接到**祖父节点** RuntimeBroker.exe,符合"根节点向上最多2层"的规则。

### 断链说明
- file日志中提到php-cgi.exe(PID:228)创建了bello.php文件
- 但php-cgi.exe没有对应的process日志,形成断链
- 这是可接受的测试场景,展示了"不完整链"的情况

## 攻击链统计

- **进程节点数**: 3 (RuntimeBroker → phpstudy_pro → xp.cn_cgi)
- **文件节点数**: 1 (bello.php)
- **网络节点数**: 1 (Webshell上传)
- **总节点数**: 5
- **链深度**: 3层 (符合"根节点向上最多2层"要求)

---
**生成时间**: 2025-11-03  
**测试场景**: Webshell文件上传攻击链 - 案例2 (断链场景)  
**主机IP**: 10.50.110.193  
**攻击源IP**: 10.50.86.151


