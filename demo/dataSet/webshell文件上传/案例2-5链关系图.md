# webshell文件上传 - 进程链关系图汇总

本文档包含案例2-5的完整进程树可视化关系图。

**图例说明**:
- 🌐 网络攻击源
- 💻 进程节点
- 📄 文件节点
- [ROOT] 根节点（告警进程）
- [ALARM] 告警节点
- [EXTEND] 扩展节点（有子进程的节点）
- 威胁等级: HIGH (高) | MEDIUM (中) | LOW (低)

---

## 案例2

### 完整进程树视图

```
└── 🌐 [webshell_upload] 10.50.86.151:51344 → 10.50.110.193:80 (TCP) [HIGH]
    └── 💻 [EXTEND] RuntimeBroker.exe (PID:424) - Administrator [LOW]
        └── 💻 [EXTEND] phpstudy_pro.exe (PID:6992) - Administrator [LOW]
            └── 💻 [EXTEND] xp.cn_cgi.exe (PID:3040) - Administrator [MEDIUM]
                └── 💻 [ROOT,ALARM] php-cgi.exe (PID:228) - Administrator [HIGH]
                    └── 📄 [webshell_file] bello.php (Backdoor/PHP.WebShell.ek) [HIGH]
```

### 统计信息

- **进程节点数**: 4
- **文件节点数**: 1
- **网络节点数**: 1
- **总节点数**: 6
- **根进程数**: 1
- **告警进程**: php-cgi.exe (PID:228)
- **恶意文件**: bello.php (Backdoor/PHP.WebShell.ek)

---

## 案例3

### 完整进程树视图

```
└── 🌐 [webshell_upload] 10.50.86.152:51343 → 10.50.111.194:80 (TCP) [HIGH]
    └── 💻 [EXTEND] services.exe (PID:765) - SYSTEM [LOW]
        ├── 💻 [EXTEND] svchost.exe (PID:897) - SYSTEM [LOW]
        │   ├── 💻 [EXTEND] RuntimeBroker.exe (PID:425) - Administrator [LOW]
        │   │   ├── 💻 [EXTEND] phpstudy_pro.exe (PID:6993) - Administrator [LOW]
        │   │   │   ├── 💻 [EXTEND] xp.cn_cgi.exe (PID:3041) - Administrator [MEDIUM]
        │   │   │   │   └── 💻 [ROOT,ALARM] php-cgi.exe (PID:1000) - Administrator [HIGH]
        │   │   │   │       └── 📄 [webshell_file] bello.php (Backdoor/PHP.WebShell.ek) [HIGH]
        │   │   │   └── 💻 [EXTEND] nginx.exe (PID:2001) - Administrator [LOW]
        │   │   │       ├── 💻 [EXTEND] worker_process.exe (PID:2002) - Administrator [LOW]
        │   │   │       │   ├── 💻 http_module.exe (PID:5001) - Administrator [LOW]
        │   │   │       │   └── 💻 ssl_module.exe (PID:5002) - Administrator [LOW]
        │   │   │       └── 💻 [EXTEND] cache_manager.exe (PID:2003) - Administrator [LOW]
        │   │   │           ├── 💻 cache_loader.exe (PID:5003) - Administrator [LOW]
        │   │   │           └── 💻 cache_purger.exe (PID:5004) - Administrator [LOW]
        │   │   └── 💻 [EXTEND] explorer.exe (PID:3001) - Administrator [LOW]
        │   │       ├── 💻 notepad.exe (PID:3002) - Administrator [LOW]
        │   │       ├── 💻 calc.exe (PID:3003) - Administrator [LOW]
        │   │       ├── 💻 mspaint.exe (PID:6001) - Administrator [LOW]
        │   │       └── 💻 cmd.exe (PID:6002) - Administrator [MEDIUM]
        │   ├── 💻 taskhost.exe (PID:4001) - SYSTEM [LOW]
        │   └── 💻 dwm.exe (PID:4002) - SYSTEM [LOW]
        ├── 💻 lsass.exe (PID:7001) - SYSTEM [LOW]
        └── 💻 spoolsv.exe (PID:7002) - SYSTEM [LOW]
```

### 统计信息

- **进程节点数**: 22
- **文件节点数**: 1
- **网络节点数**: 1
- **总节点数**: 24
- **根进程数**: 1
- **告警进程**: php-cgi.exe (PID:1000)
- **恶意文件**: bello.php (Backdoor/PHP.WebShell.ek)

---

## 案例4

### 完整进程树视图

```
└── 🌐 [webshell_upload] 10.50.86.153:51343 → 10.50.112.195:80 (TCP) [HIGH]
    └── 💻 [EXTEND] wininit.exe (PID:674) - SYSTEM [LOW]
        ├── 💻 [EXTEND] services.exe (PID:766) - SYSTEM [LOW]
        │   ├── 💻 [EXTEND] svchost.exe (PID:898) - SYSTEM [LOW]
        │   │   ├── 💻 [EXTEND] RuntimeBroker.exe (PID:426) - Administrator [LOW]
        │   │   │   ├── 💻 [EXTEND] phpstudy_pro.exe (PID:6994) - Administrator [LOW]
        │   │   │   │   ├── 💻 [EXTEND] xp.cn_cgi.exe (PID:3042) - Administrator [MEDIUM]
        │   │   │   │   │   ├── 💻 [ROOT,ALARM] php-cgi.exe (PID:1000) - Administrator [HIGH]
        │   │   │   │   │   │   └── 📄 [webshell_file] shell.php (Backdoor/PHP.WebShell.ek) [HIGH]
        │   │   │   │   │   ├── 💻 php.exe (PID:3043) - Administrator [LOW]
        │   │   │   │   │   ├── 💻 php-fpm.exe (PID:3044) - Administrator [LOW]
        │   │   │   │   │   ├── 💻 phpinfo.exe (PID:3045) - Administrator [LOW]
        │   │   │   │   │   └── 💻 composer.exe (PID:3046) - Administrator [LOW]
        │   │   │   │   ├── 💻 apache.exe (PID:6995) - Administrator [LOW]
        │   │   │   │   ├── 💻 mysql.exe (PID:6996) - Administrator [LOW]
        │   │   │   │   ├── 💻 nginx.exe (PID:6997) - Administrator [LOW]
        │   │   │   │   ├── 💻 redis.exe (PID:6998) - Administrator [LOW]
        │   │   │   │   └── 💻 memcached.exe (PID:6999) - Administrator [LOW]
        │   │   │   ├── 💻 ApplicationFrameHost.exe (PID:7001) - Administrator [LOW]
        │   │   │   ├── 💻 ShellExperienceHost.exe (PID:7002) - Administrator [LOW]
        │   │   │   ├── 💻 SearchUI.exe (PID:7003) - Administrator [LOW]
        │   │   │   ├── 💻 StartMenuExperienceHost.exe (PID:7004) - Administrator [LOW]
        │   │   │   ├── 💻 LockApp.exe (PID:7005) - Administrator [LOW]
        │   │   │   └── 💻 SystemSettings.exe (PID:7006) - Administrator [LOW]
        │   │   ├── 💻 dllhost.exe (PID:8001) - SYSTEM [LOW]
        │   │   ├── 💻 conhost.exe (PID:8002) - SYSTEM [LOW]
        │   │   ├── 💻 taskhostw.exe (PID:8003) - SYSTEM [LOW]
        │   │   ├── 💻 sihost.exe (PID:8004) - Administrator [LOW]
        │   │   └── 💻 ctfmon.exe (PID:8005) - Administrator [LOW]
        │   ├── 💻 lsass.exe (PID:9001) - SYSTEM [LOW]
        │   ├── 💻 spoolsv.exe (PID:9002) - SYSTEM [LOW]
        │   ├── 💻 wininit.exe (PID:9003) - SYSTEM [LOW]
        │   ├── 💻 csrss.exe (PID:9004) - SYSTEM [LOW]
        │   └── 💻 winlogon.exe (PID:9005) - SYSTEM [LOW]
        └── 💻 smss.exe (PID:10001) - SYSTEM [LOW]
```

### 统计信息

- **进程节点数**: 33
- **文件节点数**: 1
- **网络节点数**: 1
- **总节点数**: 35
- **根进程数**: 1
- **告警进程**: php-cgi.exe (PID:1000)
- **恶意文件**: shell.php (Backdoor/PHP.WebShell.ek)

---

## 案例5

### 完整进程树视图

```
└── 🌐 [webshell_upload] 10.50.86.155:51343 → 10.50.113.196:80 (TCP) [HIGH]
    └── 💻 [ROOT,ALARM] php-cgi.exe (PID:1000) - Administrator [HIGH]
        └── 📄 [webshell_file] malware.php (Backdoor/PHP.WebShell.ek) [HIGH]
        ├── 💻 [EXTEND] xp.cn_cgi.exe (PID:1001) - Administrator [MEDIUM]
        │   ├── 💻 [EXTEND] phpstudy_pro.exe (PID:1005) - Administrator [LOW]
        │   │   └── 💻 apache.exe (PID:1013) - SYSTEM [LOW]
        │   ├── 💻 phpstudy_pro.exe (PID:1006) - Administrator [LOW]
        │   └── 💻 [EXTEND] phpstudy_pro.exe (PID:1007) - Administrator [LOW]
        │       ├── 💻 [EXTEND] apache.exe (PID:1009) - SYSTEM [LOW]
        │       │   ├── 💻 [EXTEND] nginx.exe (PID:1017) - SYSTEM [LOW]
        │       │   │   └── 💻 RuntimeBroker.exe (PID:1030) - SYSTEM [LOW]
        │       │   └── 💻 [EXTEND] nginx.exe (PID:1024) - SYSTEM [LOW]
        │       │       ├── 💻 RuntimeBroker.exe (PID:1034) - SYSTEM [LOW]
        │       │       └── 💻 [EXTEND] RuntimeBroker.exe (PID:1037) - SYSTEM [LOW]
        │       │           ├── 💻 [EXTEND] svchost.exe (PID:1049) - SYSTEM [LOW]
        │       │           │   ├── 💻 services.exe (PID:1068) - SYSTEM [LOW]
        │       │           │   ├── 💻 services.exe (PID:1077) - SYSTEM [LOW]
        │       │           │   ├── 💻 services.exe (PID:1092) - SYSTEM [LOW]
        │       │           │   └── 💻 services.exe (PID:1096) - SYSTEM [LOW]
        │       │           └── 💻 [EXTEND] svchost.exe (PID:1057) - SYSTEM [LOW]
        │       │               ├── 💻 services.exe (PID:1061) - SYSTEM [LOW]
        │       │               ├── 💻 services.exe (PID:1085) - SYSTEM [LOW]
        │       │               └── 💻 services.exe (PID:1099) - SYSTEM [LOW]
        │       ├── 💻 [EXTEND] apache.exe (PID:1012) - SYSTEM [LOW]
        │       │   └── 💻 [EXTEND] nginx.exe (PID:1018) - SYSTEM [LOW]
        │       │       ├── 💻 RuntimeBroker.exe (PID:1026) - SYSTEM [LOW]
        │       │       └── 💻 [EXTEND] RuntimeBroker.exe (PID:1029) - SYSTEM [LOW]
        │       │           └── 💻 [EXTEND] svchost.exe (PID:1046) - SYSTEM [LOW]
        │       │               └── 💻 services.exe (PID:1063) - SYSTEM [LOW]
        │       └── 💻 [EXTEND] apache.exe (PID:1014) - SYSTEM [LOW]
        │           ├── 💻 [EXTEND] nginx.exe (PID:1016) - SYSTEM [LOW]
        │           │   ├── 💻 [EXTEND] RuntimeBroker.exe (PID:1038) - SYSTEM [LOW]
        │           │   │   ├── 💻 [EXTEND] svchost.exe (PID:1041) - SYSTEM [LOW]
        │           │   │   │   ├── 💻 services.exe (PID:1069) - SYSTEM [LOW]
        │           │   │   │   ├── 💻 services.exe (PID:1073) - SYSTEM [LOW]
        │           │   │   │   ├── 💻 services.exe (PID:1095) - SYSTEM [LOW]
        │           │   │   │   ├── 💻 services.exe (PID:1102) - SYSTEM [LOW]
        │           │   │   │   ├── 💻 services.exe (PID:1108) - SYSTEM [LOW]
        │           │   │   │   └── 💻 services.exe (PID:1111) - SYSTEM [LOW]
        │           │   │   ├── 💻 [EXTEND] svchost.exe (PID:1042) - SYSTEM [LOW]
        │           │   │   │   ├── 💻 services.exe (PID:1070) - SYSTEM [LOW]
        │           │   │   │   └── 💻 services.exe (PID:1110) - SYSTEM [LOW]
        │           │   │   └── 💻 [EXTEND] svchost.exe (PID:1056) - SYSTEM [LOW]
        │           │   │       ├── 💻 services.exe (PID:1066) - SYSTEM [LOW]
        │           │   │       ├── 💻 services.exe (PID:1072) - SYSTEM [LOW]
        │           │   │       ├── 💻 services.exe (PID:1078) - SYSTEM [LOW]
        │           │   │       ├── 💻 services.exe (PID:1082) - SYSTEM [LOW]
        │           │   │       ├── 💻 services.exe (PID:1112) - SYSTEM [LOW]
        │           │   │       └── 💻 services.exe (PID:1119) - SYSTEM [LOW]
        │           │   └── 💻 RuntimeBroker.exe (PID:1039) - SYSTEM [LOW]
        │           ├── 💻 nginx.exe (PID:1021) - SYSTEM [LOW]
        │           └── 💻 [EXTEND] nginx.exe (PID:1025) - SYSTEM [LOW]
        │               ├── 💻 [EXTEND] RuntimeBroker.exe (PID:1032) - SYSTEM [LOW]
        │               │   └── 💻 [EXTEND] svchost.exe (PID:1053) - SYSTEM [LOW]
        │               │       ├── 💻 services.exe (PID:1060) - SYSTEM [LOW]
        │               │       ├── 💻 services.exe (PID:1067) - SYSTEM [LOW]
        │               │       └── 💻 services.exe (PID:1104) - SYSTEM [LOW]
        │               └── 💻 [EXTEND] RuntimeBroker.exe (PID:1035) - SYSTEM [LOW]
        │                   ├── 💻 [EXTEND] svchost.exe (PID:1051) - SYSTEM [LOW]
        │                   │   ├── 💻 services.exe (PID:1064) - SYSTEM [LOW]
        │                   │   ├── 💻 services.exe (PID:1080) - SYSTEM [LOW]
        │                   │   ├── 💻 services.exe (PID:1089) - SYSTEM [LOW]
        │                   │   ├── 💻 services.exe (PID:1097) - SYSTEM [LOW]
        │                   │   ├── 💻 services.exe (PID:1107) - SYSTEM [LOW]
        │                   │   └── 💻 services.exe (PID:1115) - SYSTEM [LOW]
        │                   └── 💻 [EXTEND] svchost.exe (PID:1052) - SYSTEM [LOW]
        │                       ├── 💻 services.exe (PID:1059) - SYSTEM [LOW]
        │                       └── 💻 services.exe (PID:1094) - SYSTEM [LOW]
        ├── 💻 [EXTEND] xp.cn_cgi.exe (PID:1002) - Administrator [MEDIUM]
        │   └── 💻 [EXTEND] phpstudy_pro.exe (PID:1008) - Administrator [LOW]
        │       └── 💻 apache.exe (PID:1010) - SYSTEM [LOW]
        └── 💻 [EXTEND] xp.cn_cgi.exe (PID:1003) - Administrator [MEDIUM]
            └── 💻 [EXTEND] phpstudy_pro.exe (PID:1004) - Administrator [LOW]
                ├── 💻 [EXTEND] apache.exe (PID:1011) - SYSTEM [LOW]
                │   ├── 💻 nginx.exe (PID:1019) - SYSTEM [LOW]
                │   └── 💻 [EXTEND] nginx.exe (PID:1022) - SYSTEM [LOW]
                │       └── 💻 RuntimeBroker.exe (PID:1033) - SYSTEM [LOW]
                └── 💻 [EXTEND] apache.exe (PID:1015) - SYSTEM [LOW]
                    ├── 💻 [EXTEND] nginx.exe (PID:1020) - SYSTEM [LOW]
                    │   ├── 💻 [EXTEND] RuntimeBroker.exe (PID:1028) - SYSTEM [LOW]
                    │   │   ├── 💻 [EXTEND] svchost.exe (PID:1043) - SYSTEM [LOW]
                    │   │   │   ├── 💻 services.exe (PID:1087) - SYSTEM [LOW]
                    │   │   │   └── 💻 services.exe (PID:1116) - SYSTEM [LOW]
                    │   │   ├── 💻 [EXTEND] svchost.exe (PID:1045) - SYSTEM [LOW]
                    │   │   │   ├── 💻 services.exe (PID:1062) - SYSTEM [LOW]
                    │   │   │   ├── 💻 services.exe (PID:1081) - SYSTEM [LOW]
                    │   │   │   ├── 💻 services.exe (PID:1086) - SYSTEM [LOW]
                    │   │   │   ├── 💻 services.exe (PID:1090) - SYSTEM [LOW]
                    │   │   │   ├── 💻 services.exe (PID:1109) - SYSTEM [LOW]
                    │   │   │   ├── 💻 services.exe (PID:1113) - SYSTEM [LOW]
                    │   │   │   └── 💻 services.exe (PID:1117) - SYSTEM [LOW]
                    │   │   └── 💻 [EXTEND] svchost.exe (PID:1047) - SYSTEM [LOW]
                    │   │       ├── 💻 services.exe (PID:1079) - SYSTEM [LOW]
                    │   │       └── 💻 services.exe (PID:1088) - SYSTEM [LOW]
                    │   └── 💻 [EXTEND] RuntimeBroker.exe (PID:1031) - SYSTEM [LOW]
                    │       ├── 💻 [EXTEND] svchost.exe (PID:1044) - SYSTEM [LOW]
                    │       │   ├── 💻 services.exe (PID:1058) - SYSTEM [LOW]
                    │       │   ├── 💻 services.exe (PID:1065) - SYSTEM [LOW]
                    │       │   └── 💻 services.exe (PID:1083) - SYSTEM [LOW]
                    │       └── 💻 [EXTEND] svchost.exe (PID:1050) - SYSTEM [LOW]
                    │           ├── 💻 services.exe (PID:1084) - SYSTEM [LOW]
                    │           ├── 💻 services.exe (PID:1093) - SYSTEM [LOW]
                    │           ├── 💻 services.exe (PID:1098) - SYSTEM [LOW]
                    │           └── 💻 services.exe (PID:1100) - SYSTEM [LOW]
                    └── 💻 [EXTEND] nginx.exe (PID:1023) - SYSTEM [LOW]
                        ├── 💻 [EXTEND] RuntimeBroker.exe (PID:1027) - SYSTEM [LOW]
                        │   ├── 💻 [EXTEND] svchost.exe (PID:1040) - SYSTEM [LOW]
                        │   │   ├── 💻 services.exe (PID:1091) - SYSTEM [LOW]
                        │   │   ├── 💻 services.exe (PID:1101) - SYSTEM [LOW]
                        │   │   └── 💻 services.exe (PID:1118) - SYSTEM [LOW]
                        │   ├── 💻 [EXTEND] svchost.exe (PID:1048) - SYSTEM [LOW]
                        │   │   ├── 💻 services.exe (PID:1076) - SYSTEM [LOW]
                        │   │   ├── 💻 services.exe (PID:1103) - SYSTEM [LOW]
                        │   │   └── 💻 services.exe (PID:1106) - SYSTEM [LOW]
                        │   └── 💻 [EXTEND] svchost.exe (PID:1055) - SYSTEM [LOW]
                        │       ├── 💻 services.exe (PID:1105) - SYSTEM [LOW]
                        │       └── 💻 services.exe (PID:1114) - SYSTEM [LOW]
                        └── 💻 [EXTEND] RuntimeBroker.exe (PID:1036) - SYSTEM [LOW]
                            └── 💻 [EXTEND] svchost.exe (PID:1054) - SYSTEM [LOW]
                                ├── 💻 services.exe (PID:1071) - SYSTEM [LOW]
                                ├── 💻 services.exe (PID:1074) - SYSTEM [LOW]
                                └── 💻 services.exe (PID:1075) - SYSTEM [LOW]
```

### 统计信息

- **进程节点数**: 120
- **文件节点数**: 1
- **网络节点数**: 1
- **总节点数**: 122
- **根进程数**: 1
- **告警进程**: php-cgi.exe (PID:1000)
- **恶意文件**: malware.php (Backdoor/PHP.WebShell.ek)

---

