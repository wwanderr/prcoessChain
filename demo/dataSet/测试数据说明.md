# 测试数据说明文档

## 📁 文件结构

每个场景（webshell文件上传、命令执行、矿池）都包含5个案例：

```
dataSet/
├── webshell文件上传/
│   ├── 案例1/  (已存在 - 基础测试,2节点)
│   ├── 案例2/  (中等复杂度,5层15节点)
│   ├── 案例3/  (分支链,6层25节点)
│   ├── 案例4/  (长链,8层40节点)
│   └── 案例5/  (超大链,8层120节点,需裁剪)
├── 命令执行/
│   ├── 案例1/  (已存在 - 基础测试)
│   ├── 案例2/  (5层12节点)
│   ├── 案例3/  (6层22节点,分支)
│   ├── 案例4/  (7层35节点)
│   └── 案例5/  (8层110节点,需裁剪)
└── 矿池/
    ├── 案例1/  (已存在 - 基础测试)
    ├── 案例2/  (5层10节点)
    ├── 案例3/  (6层20节点,分支)
    ├── 案例4/  (7层38节点)
    └── 案例5/  (8层115节点,需裁剪)
```

## 📝 数据格式

每个案例文件夹包含一个 `test_data.txt` 文件：
- **第1行**: 网侧数据（告警JSON）
- **第2行及以后**: 端侧数据（每行一个进程/文件日志JSON）

### 示例格式
```
{网侧告警JSON}
{端侧日志JSON-1}
{端侧日志JSON-2}
...
```

## 🔑 关键字段说明

### 每个案例的唯一标识

| 场景 | 案例 | IP | traceId | productVendorName |
|------|------|----|---------|--------------------|
| webshell文件上传 | 1 | 10.50.109.192 | traceId-985 | 杭州安恒信息技术股份有限公司 |
| webshell文件上传 | 2 | 10.50.110.193 | traceId-986 | Qihoo360 |
| webshell文件上传 | 3 | 10.50.111.194 | traceId-987 | Kaspersky |
| webshell文件上传 | 4 | 10.50.112.195 | traceId-988 | Symantec |
| webshell文件上传 | 5 | 10.50.113.196 | traceId-989 | TrendMicro |
| 命令执行 | 1 | 10.50.109.192 | traceId-211 | 杭州安恒信息技术股份有限公司 |
| 命令执行 | 2 | 10.50.114.197 | traceId-212 | McAfee |
| 命令执行 | 3 | 10.50.115.198 | traceId-213 | Sophos |
| 命令执行 | 4 | 10.50.116.199 | traceId-214 | ESET |
| 命令执行 | 5 | 10.50.117.200 | traceId-215 | Bitdefender |
| 矿池 | 1 | 10.50.109.192 | traceId-205 | 杭州安恒信息技术股份有限公司 |
| 矿池 | 2 | 10.50.118.201 | traceId-206 | Avast |
| 矿池 | 3 | 10.50.119.202 | traceId-207 | AVG |
| 矿池 | 4 | 10.50.120.203 | traceId-208 | Panda |
| 矿池 | 5 | 10.50.121.204 | traceId-209 | Comodo |

## 🎯 测试目标

### 案例1 - 基础功能测试
- **目标**: 验证基本的进程链构建
- **特点**: 简单线性链，2-3个节点
- **验证点**: 根节点识别、父子关系、网端关联

### 案例2 - 中等复杂度
- **目标**: 测试多层进程链处理
- **特点**: 5层，10-15个节点，线性结构
- **验证点**: 深度遍历、时间顺序、链完整性

### 案例3 - 分支链测试
- **目标**: 测试分支进程链
- **特点**: 6层，20-25个节点，包含2-3个分支
- **验证点**: 分支识别、并发子进程、独立性

### 案例4 - 长链测试
- **目标**: 测试深层进程链
- **特点**: 7-8层，35-40个节点
- **验证点**: 深度限制、性能、内存占用

### 案例5 - 裁剪测试
- **目标**: 测试智能裁剪功能
- **特点**: 8层，110-120个节点，超过100节点限制
- **验证点**: 裁剪算法、保留关键节点、威胁等级

## 🔍 验证方法

### 1. 数据完整性检查
```bash
# 检查每个文件的行数
wc -l */案例*/test_data.txt

# 验证JSON格式
cat test_data.txt | while read line; do echo $line | jq . > /dev/null || echo "Invalid JSON"; done
```

### 2. 关键字段验证
- traceId 唯一性
- IP 地址一致性
- processGuid 和 parentProcessGuid 关联
- 时间戳顺序

### 3. 进程链验证
- 根节点存在
- 无环路
- 父子关系完整
- 层数符合预期

## 📊 数据统计

| 场景 | 总案例数 | 总节点数 | 平均节点数 | 最大深度 |
|------|----------|----------|------------|----------|
| webshell文件上传 | 5 | ~202 | 40.4 | 8 |
| 命令执行 | 5 | ~179 | 35.8 | 8 |
| 矿池 | 5 | ~183 | 36.6 | 8 |
| **总计** | **15** | **~564** | **37.6** | **8** |

## 🚀 使用建议

1. **单元测试**: 从案例1开始，逐步增加复杂度
2. **性能测试**: 使用案例5测试裁剪和性能
3. **边界测试**: 验证最大深度(8层)和最大节点数(120)
4. **集成测试**: 混合多个案例，测试并发处理

## ⚠️ 注意事项

1. 所有时间戳使用2025年5月数据
2. IP地址段: 10.50.109-121.192-204
3. traceId格式: traceId-XXX (3位数字)
4. productVendorName 每个案例不同，便于区分
5. 网侧数据的 srcAddress 和 destAddress 需要与端侧的 hostAddress 匹配







